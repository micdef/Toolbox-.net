<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="__email_message_8cs_source" xml:lang="en-US">
<title>EmailMessage.cs</title>
<indexterm><primary>C:/Users/micde/RiderProjects/Toolbox/src/Toolbox.Core/Options/EmailMessage.cs</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="__email_message_8cs_source_1l00001"/>00001 <emphasis role="comment">//&#32;@file&#32;EmailMessage.cs</emphasis>
<anchor xml:id="__email_message_8cs_source_1l00002"/>00002 <emphasis role="comment">//&#32;@brief&#32;Email&#32;message&#32;representation</emphasis>
<anchor xml:id="__email_message_8cs_source_1l00003"/>00003 <emphasis role="comment">//&#32;@details&#32;Contains&#32;all&#32;the&#32;data&#32;needed&#32;to&#32;send&#32;an&#32;email</emphasis>
<anchor xml:id="__email_message_8cs_source_1l00004"/>00004 <emphasis role="comment">//&#32;@note&#32;Supports&#32;multiple&#32;recipients,&#32;CC,&#32;BCC,&#32;and&#32;attachments</emphasis>
<anchor xml:id="__email_message_8cs_source_1l00005"/>00005 
<anchor xml:id="__email_message_8cs_source_1l00006"/>00006 <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespace_toolbox_1_1_core_1_1_options">Toolbox.Core.Options</link>;
<anchor xml:id="__email_message_8cs_source_1l00007"/>00007 
<anchor xml:id="__email_message_8cs_source_1l00035"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message">00035</link> <emphasis role="keyword">public</emphasis>&#32;<emphasis role="keyword">sealed</emphasis>&#32;<emphasis role="keyword">class&#32;</emphasis><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message">EmailMessage</link>
<anchor xml:id="__email_message_8cs_source_1l00036"/>00036 {
<anchor xml:id="__email_message_8cs_source_1l00041"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ae81d3000119c9b12dfffe302a6ed34e1">00041</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</link>?&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ae81d3000119c9b12dfffe302a6ed34e1">From</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00042"/>00042 
<anchor xml:id="__email_message_8cs_source_1l00047"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ad1e2b8d83269be70648b1ea4c001c428">00047</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</link>?&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ad1e2b8d83269be70648b1ea4c001c428">ReplyTo</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00048"/>00048 
<anchor xml:id="__email_message_8cs_source_1l00053"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a2a22cf3d9bd7c67d8ac73aab098fa24e">00053</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;IList&lt;EmailAddress&gt;&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a2a22cf3d9bd7c67d8ac73aab098fa24e">To</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;}&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;List&lt;EmailAddress&gt;();
<anchor xml:id="__email_message_8cs_source_1l00054"/>00054 
<anchor xml:id="__email_message_8cs_source_1l00059"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a30f5834090bbf7c36de92bd0de29f290">00059</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;IList&lt;EmailAddress&gt;&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a30f5834090bbf7c36de92bd0de29f290">Cc</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;}&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;List&lt;EmailAddress&gt;();
<anchor xml:id="__email_message_8cs_source_1l00060"/>00060 
<anchor xml:id="__email_message_8cs_source_1l00065"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a1fde3f15e549c1ce10418ea24a8ee79b">00065</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;IList&lt;EmailAddress&gt;&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a1fde3f15e549c1ce10418ea24a8ee79b">Bcc</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;}&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;List&lt;EmailAddress&gt;();
<anchor xml:id="__email_message_8cs_source_1l00066"/>00066 
<anchor xml:id="__email_message_8cs_source_1l00071"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a2878058a0675907e71f46085dd7c1e0f">00071</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">string</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a2878058a0675907e71f46085dd7c1e0f">Subject</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}&#32;=&#32;<emphasis role="keywordtype">string</emphasis>.Empty;
<anchor xml:id="__email_message_8cs_source_1l00072"/>00072 
<anchor xml:id="__email_message_8cs_source_1l00077"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1acc148135731267f616b58707b0e4132d">00077</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">string</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1acc148135731267f616b58707b0e4132d">Body</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}&#32;=&#32;<emphasis role="keywordtype">string</emphasis>.Empty;
<anchor xml:id="__email_message_8cs_source_1l00078"/>00078 
<anchor xml:id="__email_message_8cs_source_1l00083"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a82878f0f02674c42c078a1d0a85bc1bf">00083</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a82878f0f02674c42c078a1d0a85bc1bf">IsBodyHtml</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00084"/>00084 
<anchor xml:id="__email_message_8cs_source_1l00092"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a667aa502ae68efb886b63e93b06a695b">00092</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">string</emphasis>?&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a667aa502ae68efb886b63e93b06a695b">PlainTextBody</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00093"/>00093 
<anchor xml:id="__email_message_8cs_source_1l00098"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a7ec40f4c0801e9d635c33cdcd29cbf03">00098</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;IList&lt;EmailAttachment&gt;&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a7ec40f4c0801e9d635c33cdcd29cbf03">Attachments</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;}&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;List&lt;EmailAttachment&gt;();
<anchor xml:id="__email_message_8cs_source_1l00099"/>00099 
<anchor xml:id="__email_message_8cs_source_1l00104"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1abfe1f4e9814f5b67aa2122fafef4804a">00104</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778">EmailPriority</link>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1abfe1f4e9814f5b67aa2122fafef4804a">Priority</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;<emphasis role="keyword">set</emphasis>;&#32;}&#32;=&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778">EmailPriority</link>.Normal;
<anchor xml:id="__email_message_8cs_source_1l00105"/>00105 
<anchor xml:id="__email_message_8cs_source_1l00110"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ac8af8d8afbb92f19ee7e9584906778d3">00110</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;IDictionary&lt;string,&#32;string&gt;&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1ac8af8d8afbb92f19ee7e9584906778d3">Headers</link>&#32;{&#32;<emphasis role="keyword">get</emphasis>;&#32;}&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;Dictionary&lt;string,&#32;string&gt;();
<anchor xml:id="__email_message_8cs_source_1l00111"/>00111 
<anchor xml:id="__email_message_8cs_source_1l00116"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a3e25efe03279f3b48fbf34eabcde53e2">00116</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a3e25efe03279f3b48fbf34eabcde53e2">TotalRecipients</link>&#32;=&gt;&#32;To.Count&#32;+&#32;Cc.Count&#32;+&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a1fde3f15e549c1ce10418ea24a8ee79b">Bcc</link>.Count;
<anchor xml:id="__email_message_8cs_source_1l00117"/>00117 
<anchor xml:id="__email_message_8cs_source_1l00122"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a6e9f18a8cfe7ea88b2547402868d41ce">00122</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a6e9f18a8cfe7ea88b2547402868d41ce">HasRecipients</link>&#32;=&gt;&#32;To.Count&#32;&gt;&#32;0&#32;||&#32;Bcc.Count&#32;&gt;&#32;0;
<anchor xml:id="__email_message_8cs_source_1l00123"/>00123 
<anchor xml:id="__email_message_8cs_source_1l00128"/><link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a631a28ef3c2b8a847205df409b4d83a2">00128</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">public</emphasis>&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a631a28ef3c2b8a847205df409b4d83a2">Validate</link>()
<anchor xml:id="__email_message_8cs_source_1l00129"/>00129 &#32;&#32;&#32;&#32;{
<anchor xml:id="__email_message_8cs_source_1l00130"/>00130 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(!<link linkend="_class_toolbox_1_1_core_1_1_options_1_1_email_message_1a6e9f18a8cfe7ea88b2547402868d41ce">HasRecipients</link>)
<anchor xml:id="__email_message_8cs_source_1l00131"/>00131 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{
<anchor xml:id="__email_message_8cs_source_1l00132"/>00132 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">throw</emphasis>&#32;<emphasis role="keyword">new</emphasis>&#32;ArgumentException(<emphasis role="stringliteral">&quot;Email&#32;must&#32;have&#32;at&#32;least&#32;one&#32;recipient&#32;in&#32;To&#32;or&#32;BCC.&quot;</emphasis>);
<anchor xml:id="__email_message_8cs_source_1l00133"/>00133 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00134"/>00134 &#32;&#32;&#32;&#32;}
<anchor xml:id="__email_message_8cs_source_1l00135"/>00135 }
<anchor xml:id="__email_message_8cs_source_1l00136"/>00136 
<anchor xml:id="__email_message_8cs_source_1l00140"/><link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778">00140</link> <emphasis role="keyword">public</emphasis>&#32;<emphasis role="keyword">enum</emphasis>&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778">EmailPriority</link>
<anchor xml:id="__email_message_8cs_source_1l00141"/>00141 {
<anchor xml:id="__email_message_8cs_source_1l00143"/><link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a28d0edd045e05cf5af64e35ae0c4c6ef">00143</link> &#32;&#32;&#32;&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a28d0edd045e05cf5af64e35ae0c4c6ef">Low</link>&#32;=&#32;0,
<anchor xml:id="__email_message_8cs_source_1l00144"/>00144 
<anchor xml:id="__email_message_8cs_source_1l00146"/><link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a960b44c579bc2f6818d2daaf9e4c16f0">00146</link> &#32;&#32;&#32;&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a960b44c579bc2f6818d2daaf9e4c16f0">Normal</link>&#32;=&#32;1,
<anchor xml:id="__email_message_8cs_source_1l00147"/>00147 
<anchor xml:id="__email_message_8cs_source_1l00149"/><link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a655d20c1ca69519ca647684edbb2db35">00149</link> &#32;&#32;&#32;&#32;<link linkend="_namespace_toolbox_1_1_core_1_1_options_1ae7d22020ff38ac3c9033e77d09540778a655d20c1ca69519ca647684edbb2db35">High</link>&#32;=&#32;2
<anchor xml:id="__email_message_8cs_source_1l00150"/>00150 }
</programlisting></section>
