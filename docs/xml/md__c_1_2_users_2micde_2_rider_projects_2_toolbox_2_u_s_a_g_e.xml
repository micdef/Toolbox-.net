<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.16.1" xml:lang="en-US">
  <compounddef id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e" kind="page">
    <compoundname>md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e</compoundname>
    <title>Toolbox Usage Guide</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><anchor id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md46"/></para>
<para>This guide provides detailed instructions for using the Toolbox library.</para>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md47">
<title>Table of Contents</title><para><orderedlist>
<listitem><para>Getting Started</para>
</listitem><listitem><para>Cryptography Services<itemizedlist>
<listitem><para>Base64 Encoding</para>
</listitem><listitem><para>AES Encryption</para>
</listitem><listitem><para>RSA Encryption</para>
</listitem></itemizedlist>
</para>
</listitem><listitem><para>File Transfer Services<itemizedlist>
<listitem><para>FTP/FTPS</para>
</listitem><listitem><para>SFTP</para>
</listitem></itemizedlist>
</para>
</listitem><listitem><para>Mailing Services</para>
</listitem><listitem><para>API Services</para>
</listitem><listitem><para>LDAP Services<itemizedlist>
<listitem><para>Active Directory</para>
</listitem><listitem><para>Azure AD / Entra ID</para>
</listitem><listitem><para>OpenLDAP</para>
</listitem><listitem><para>Apple Directory</para>
</listitem><listitem><para>Advanced Authentication</para>
</listitem></itemizedlist>
</para>
</listitem><listitem><para>SSO Services<itemizedlist>
<listitem><para>Session Management</para>
</listitem><listitem><para>Credential Storage</para>
</listitem><listitem><para>Automatic Token Refresh</para>
</listitem></itemizedlist>
</para>
</listitem><listitem><para>Creating Custom Services</para>
</listitem><listitem><para>OpenTelemetry Integration</para>
</listitem><listitem><para>Configuration Options</para>
</listitem><listitem><para>Best Practices</para>
</listitem></orderedlist>
</para>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md48">
<title>Getting Started</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md49">
<title>Basic Setup</title><para>Add Toolbox to your application:</para>
<para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>builder<sp/>=<sp/>Host.CreateApplicationBuilder(args);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Register<sp/>Toolbox<sp/>core<sp/>services</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">builder.Services.AddToolboxCore();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>app<sp/>=<sp/>builder.Build();</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md50">
<title>Configuration via appsettings.json</title><para><programlisting filename=".json"><codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;Toolbox&quot;:<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;EnableDetailedTelemetry&quot;:<sp/>false,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;ServicePrefix&quot;:<sp/>&quot;MyApp&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;AsyncDisposalTimeout&quot;:<sp/>&quot;00:00:30&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>},</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>&quot;Toolbox:Telemetry&quot;:<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;EnableTracing&quot;:<sp/>true,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;EnableMetrics&quot;:<sp/>true,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;EnableConsoleExport&quot;:<sp/>false,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;ServiceName&quot;:<sp/>&quot;MyApplication&quot;,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>&quot;ServiceVersion&quot;:<sp/>&quot;1.0.0&quot;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><programlisting filename=".cs"><codeline><highlight class="normal">builder.Services.AddToolboxCore(builder.Configuration);</highlight></codeline>
<codeline><highlight class="normal">builder.Services.AddToolboxOpenTelemetry(builder.Configuration);</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md52">
<title>Cryptography Services</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md53">
<title>Base64 Encoding</title><para>Base64 encoding/decoding service for text obfuscation (not encryption).</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md54">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Standard<sp/>Base64</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddBase64Cryptography();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>URL-safe<sp/>Base64</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddBase64Cryptography(Base64EncodingTable.UrlSafe);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>With<sp/>full<sp/>options</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddBase64Cryptography(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.EncodingTable<sp/>=<sp/>Base64EncodingTable.UrlSafe;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.IncludePadding<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md55">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">MyService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ICryptographyService<sp/>_crypto;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>MyService(ICryptographyService<sp/>crypto)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_crypto<sp/>=<sp/>crypto;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>ProcessAsync()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Encode</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>encoded<sp/>=<sp/>_crypto.Encrypt(</highlight><highlight class="stringliteral">&quot;Hello,<sp/>World!&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Result:<sp/>&quot;SGVsbG8sIFdvcmxkIQ==&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Decode</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>decoded<sp/>=<sp/>_crypto.Decrypt(encoded);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Result:<sp/>&quot;Hello,<sp/>World!&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Async<sp/>versions</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>encodedAsync<sp/>=<sp/>await<sp/>_crypto.EncryptAsync(</highlight><highlight class="stringliteral">&quot;Hello&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>decodedAsync<sp/>=<sp/>await<sp/>_crypto.DecryptAsync(encodedAsync);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md57">
<title>AES Encryption</title><para>Secure symmetric encryption using AES (CBC mode with PKCS7 padding).</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md58">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generate<sp/>new<sp/>key<sp/>and<sp/>IV</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>(key,<sp/>iv)<sp/>=<sp/>AesCryptographyService.GenerateKey(AesKeySize.Aes256);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Register<sp/>with<sp/>generated<sp/>key</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAesCryptography(key,<sp/>iv);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Or<sp/>with<sp/>key<sp/>size<sp/>enum</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAesCryptography(AesKeySize.Aes256);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md59">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">SecureService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ICryptographyService<sp/>_crypto;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SecureService(ICryptographyService<sp/>crypto)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_crypto<sp/>=<sp/>crypto;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;string&gt;<sp/>EncryptDataAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>sensitiveData)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Encrypt<sp/>(returns<sp/>Base64-encoded<sp/>ciphertext)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>encrypted<sp/>=<sp/>await<sp/>_crypto.EncryptAsync(sensitiveData);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Decrypt</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>decrypted<sp/>=<sp/>await<sp/>_crypto.DecryptAsync(encrypted);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>encrypted;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md60">
<title>Key Generation</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Generate<sp/>AES-128<sp/>key</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>(key128,<sp/>iv128)<sp/>=<sp/>AesCryptographyService.GenerateKey(AesKeySize.Aes128);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generate<sp/>AES-192<sp/>key</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>(key192,<sp/>iv192)<sp/>=<sp/>AesCryptographyService.GenerateKey(AesKeySize.Aes192);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generate<sp/>AES-256<sp/>key<sp/>(recommended)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>(key256,<sp/>iv256)<sp/>=<sp/>AesCryptographyService.GenerateKey(AesKeySize.Aes256);</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md62">
<title>RSA Encryption</title><para>Asymmetric encryption using RSA with various key sizes and padding modes.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md63">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generate<sp/>key<sp/>pair</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>keyPair<sp/>=<sp/>RsaCryptographyService.GenerateKeyPair(RsaKeySize.Rsa2048);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Register<sp/>with<sp/>full<sp/>key<sp/>pair<sp/>(encrypt<sp/>+<sp/>decrypt)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddRsaCryptography(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>keyPair.PublicKey!,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RsaPaddingMode.OaepSha256,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>keyPair.PrivateKey);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Register<sp/>with<sp/>public<sp/>key<sp/>only<sp/>(encrypt<sp/>only)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddRsaCryptography(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>keyPair.PublicKey!,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RsaPaddingMode.OaepSha256);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Register<sp/>with<sp/>X.509<sp/>certificate</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>cert<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>X509Certificate2(</highlight><highlight class="stringliteral">&quot;certificate.pfx&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">services.AddRsaCryptography(cert,<sp/>RsaPaddingMode.OaepSha256);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md64">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">AsymmetricService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ICryptographyService<sp/>_crypto;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>AsymmetricService(ICryptographyService<sp/>crypto)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_crypto<sp/>=<sp/>crypto;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>encrypted,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>decrypted)&gt;<sp/>ProcessAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>data)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Encrypt<sp/>with<sp/>public<sp/>key</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>encrypted<sp/>=<sp/>await<sp/>_crypto.EncryptAsync(data);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Decrypt<sp/>with<sp/>private<sp/>key<sp/>(requires<sp/>private<sp/>key)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>decrypted<sp/>=<sp/>await<sp/>_crypto.DecryptAsync(encrypted);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(encrypted,<sp/>decrypted);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md65">
<title>Key Generation</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Generate<sp/>key<sp/>pair<sp/>(bytes)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>keyPair<sp/>=<sp/>RsaCryptographyService.GenerateKeyPair(RsaKeySize.Rsa2048);</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/>publicKey<sp/>=<sp/>keyPair.PublicKey!;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/>privateKey<sp/>=<sp/>keyPair.PrivateKey!;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generate<sp/>self-signed<sp/>certificate</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>certKeyPair<sp/>=<sp/>RsaCryptographyService.GenerateCertificate(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RsaKeySize.Rsa4096,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CN=MyApplication&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>TimeSpan.FromDays(365));</highlight></codeline>
<codeline><highlight class="normal">X509Certificate2<sp/>certificate<sp/>=<sp/>certKeyPair.Certificate!;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Public<sp/>key<sp/>only<sp/>(for<sp/>sharing)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>publicOnly<sp/>=<sp/>RsaCryptographyService.GenerateKeyPair(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RsaKeySize.Rsa2048,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>includePrivateKey:<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md66">
<title>Padding Modes</title><para><table rows="6" cols="2"><row>
<entry thead="yes"><para>Mode  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Pkcs1</computeroutput>  </para>
</entry><entry thead="no"><para>PKCS#1 v1.5 padding (legacy)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OaepSha1</computeroutput>  </para>
</entry><entry thead="no"><para>OAEP with SHA-1  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OaepSha256</computeroutput>  </para>
</entry><entry thead="no"><para>OAEP with SHA-256 (recommended)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OaepSha384</computeroutput>  </para>
</entry><entry thead="no"><para>OAEP with SHA-384  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OaepSha512</computeroutput>  </para>
</entry><entry thead="no"><para>OAEP with SHA-512  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md68">
<title>File Transfer Services</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md69">
<title>FTP/FTPS</title><para>File transfer service for FTP and FTPS (FTP over TLS) protocols.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md70">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Basic<sp/>FTP</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddFtpFileTransfer(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ftp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>21;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Protocol<sp/>=<sp/>FileTransferProtocol.Ftp;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Secure<sp/>FTPS</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddFtpFileTransfer(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ftp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>21;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Protocol<sp/>=<sp/>FileTransferProtocol.Ftps;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddFtpFileTransfer(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Ftp&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md71">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">FileService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>IFileTransferService<sp/>_ftp;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>FileService(IFileTransferService<sp/>ftp)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ftp<sp/>=<sp/>ftp;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>TransferFilesAsync()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Upload<sp/>single<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_ftp.UploadOneAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localPath:<sp/></highlight><highlight class="stringliteral">@&quot;C:\local\file.txt&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotePath:<sp/></highlight><highlight class="stringliteral">&quot;/remote/file.txt&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overwrite:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Download<sp/>single<sp/>file</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_ftp.DownloadOneAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>remotePath:<sp/></highlight><highlight class="stringliteral">&quot;/remote/file.txt&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localPath:<sp/></highlight><highlight class="stringliteral">@&quot;C:\local\downloaded.txt&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Batch<sp/>upload</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>uploads<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal">[]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">@&quot;C:\local\file1.txt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;/remote/file1.txt&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">@&quot;C:\local\file2.txt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;/remote/file2.txt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>successCount<sp/>=<sp/>await<sp/>_ftp.UploadBatchAsync(uploads);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Batch<sp/>download</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>downloads<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal">[]</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;/remote/file1.txt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">@&quot;C:\local\file1.txt&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;/remote/file2.txt&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">@&quot;C:\local\file2.txt&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>downloaded<sp/>=<sp/>await<sp/>_ftp.DownloadBatchAsync(downloads);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md73">
<title>SFTP</title><para>Secure file transfer over SSH (SFTP protocol).</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md74">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Password<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSftpFileTransfer(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;sftp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>22;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Private<sp/>key<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSftpFileTransfer(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;sftp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>22;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.PrivateKeyPath<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;C:\keys\id_rsa&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.PrivateKeyPassphrase<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;passphrase&quot;</highlight><highlight class="normal">;<sp/></highlight><highlight class="comment">//<sp/>Optional</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Private<sp/>key<sp/>from<sp/>string</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSftpFileTransfer(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;sftp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.PrivateKeyContent<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;-----BEGIN<sp/>RSA<sp/>PRIVATE<sp/>KEY-----\n...&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md75">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">SecureFileService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>IFileTransferService<sp/>_sftp;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SecureFileService(IFileTransferService<sp/>sftp)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_sftp<sp/>=<sp/>sftp;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>TransferAsync(CancellationToken<sp/>ct)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Upload<sp/>with<sp/>cancellation<sp/>support</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_sftp.UploadOneAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">@&quot;C:\data\report.pdf&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;/uploads/report.pdf&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>overwrite:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ct);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Download</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_sftp.DownloadOneAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;/downloads/data.csv&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">@&quot;C:\data\data.csv&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cancellationToken:<sp/>ct);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md76">
<title>Configuration Options</title><para><table rows="13" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Host</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Server hostname  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Port</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>21/22  </para>
</entry><entry thead="no"><para>Server port  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Username</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Login username  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Password</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Password (if using password auth)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PrivateKeyPath</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Path to private key file  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PrivateKeyContent</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Private key as string  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PrivateKeyPassphrase</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Private key passphrase  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Protocol</computeroutput>  </para>
</entry><entry thead="no"><para>FileTransferProtocol  </para>
</entry><entry thead="no"><para>Ftp  </para>
</entry><entry thead="no"><para>Ftp, Ftps, or Sftp  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ConnectionTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>30s  </para>
</entry><entry thead="no"><para>Connection timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OperationTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>5min  </para>
</entry><entry thead="no"><para>Operation timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BufferSize</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>32KB  </para>
</entry><entry thead="no"><para>Transfer buffer size  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AutoCreateDirectory</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Auto-create remote directories  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md78">
<title>Mailing Services</title><para>SMTP email sending service with TLS/SSL, OAuth2, and attachment support.</para>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md79">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Generic<sp/>SMTP</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSmtpMailing(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;smtp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>587;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.SecurityMode<sp/>=<sp/>SmtpSecurityMode.StartTls;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;user@example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.DefaultFrom<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(</highlight><highlight class="stringliteral">&quot;noreply@example.com&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;My<sp/>App&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Gmail<sp/>shortcut</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddGmailMailing(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>email:<sp/></highlight><highlight class="stringliteral">&quot;myapp@gmail.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>appPassword:<sp/></highlight><highlight class="stringliteral">&quot;xxxx-xxxx-xxxx-xxxx&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Outlook/Office<sp/>365<sp/>shortcut</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddOutlookMailing(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>email:<sp/></highlight><highlight class="stringliteral">&quot;myapp@outlook.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>password:<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Anonymous<sp/>relay<sp/>(internal<sp/>servers)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSmtpMailing(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;mail.internal.local&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>25;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.SecurityMode<sp/>=<sp/>SmtpSecurityMode.None;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSmtpMailing(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Mailing&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md80">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">NotificationService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>IMailingService<sp/>_mailing;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>NotificationService(IMailingService<sp/>mailing)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_mailing<sp/>=<sp/>mailing;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>SendWelcomeEmailAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userEmail,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userName)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>message<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailMessage</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>From<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(</highlight><highlight class="stringliteral">&quot;noreply@example.com&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;My<sp/>Application&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Subject<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Welcome<sp/>to<sp/>Our<sp/>Service!&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Body<sp/>=<sp/>$</highlight><highlight class="stringliteral">&quot;&lt;h1&gt;Welcome,<sp/>{userName}!&lt;/h1&gt;&lt;p&gt;Thank<sp/>you<sp/>for<sp/>joining<sp/>us.&lt;/p&gt;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IsBodyHtml<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>To<sp/>=<sp/>{<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(userEmail,<sp/>userName)<sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_mailing.SendMailAsync(message);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>SendReportAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal">[]<sp/>recipients,<sp/></highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/>pdfReport)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>message<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailMessage</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>From<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(</highlight><highlight class="stringliteral">&quot;reports@example.com&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;Report<sp/>System&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Subject<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Monthly<sp/>Report&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Body<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Please<sp/>find<sp/>the<sp/>monthly<sp/>report<sp/>attached.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IsBodyHtml<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Attachments<sp/>=</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EmailAttachment.FromBytes(pdfReport,<sp/></highlight><highlight class="stringliteral">&quot;report.pdf&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;application/pdf&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Multiple<sp/>recipients</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>(var<sp/>recipient<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>recipients)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.To.Add(recipient);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_mailing.SendMailAsync(message);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>SendBccEmailAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal">[]<sp/>bccRecipients)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Email<sp/>with<sp/>BCC<sp/>only<sp/>(no<sp/>visible<sp/>recipients)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>message<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailMessage</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>From<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(</highlight><highlight class="stringliteral">&quot;newsletter@example.com&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Subject<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Newsletter&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Body<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&lt;h1&gt;Monthly<sp/>Newsletter&lt;/h1&gt;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IsBodyHtml<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>(var<sp/>bcc<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>bccRecipients)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message.Bcc.Add(bcc);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_mailing.SendMailAsync(message);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md81">
<title>Email with Inline Images</title><para><programlisting filename=".cs"><codeline><highlight class="normal">var<sp/>logoBytes<sp/>=<sp/>File.ReadAllBytes(</highlight><highlight class="stringliteral">&quot;logo.png&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>message<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailMessage</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>From<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>EmailAddress(</highlight><highlight class="stringliteral">&quot;noreply@example.com&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Subject<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;Email<sp/>with<sp/>Logo&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Body<sp/>=<sp/></highlight><highlight class="stringliteral">@&quot;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;html&gt;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;body&gt;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;img<sp/>src=&apos;cid:company-logo&apos;<sp/>alt=&apos;Logo&apos;<sp/>/&gt;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;h1&gt;Welcome!&lt;/h1&gt;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;/body&gt;</highlight></codeline>
<codeline><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;/html&gt;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IsBodyHtml<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>To<sp/>=<sp/>{<sp/></highlight><highlight class="stringliteral">&quot;recipient@example.com&quot;</highlight><highlight class="normal"><sp/>},</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Attachments<sp/>=</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EmailAttachment.CreateInline(logoBytes,<sp/></highlight><highlight class="stringliteral">&quot;logo.png&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;company-logo&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">await<sp/>_mailing.SendMailAsync(message);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md82">
<title>Configuration Options</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Host</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>&quot;localhost&quot;  </para>
</entry><entry thead="no"><para>SMTP server hostname  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Port</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>25  </para>
</entry><entry thead="no"><para>SMTP port (25, 587, 465)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SecurityMode</computeroutput>  </para>
</entry><entry thead="no"><para>SmtpSecurityMode  </para>
</entry><entry thead="no"><para>Auto  </para>
</entry><entry thead="no"><para>Security mode  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Username</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>SMTP username  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Password</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>SMTP password  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OAuth2AccessToken</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>OAuth2 token (Gmail, O365)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ConnectionTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>30s  </para>
</entry><entry thead="no"><para>Connection timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OperationTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>2min  </para>
</entry><entry thead="no"><para>Send timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ValidateCertificate</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Validate SSL certificate  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DefaultFrom</computeroutput>  </para>
</entry><entry thead="no"><para>EmailAddress?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Default sender address  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DefaultReplyTo</computeroutput>  </para>
</entry><entry thead="no"><para>EmailAddress?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Default reply-to address  </para>
</entry></row>
</table>
</para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md83">
<title>Security Modes</title><para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Mode  </para>
</entry><entry thead="yes"><para>Port  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Auto</computeroutput>  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Automatic detection  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>None</computeroutput>  </para>
</entry><entry thead="no"><para>25  </para>
</entry><entry thead="no"><para>No encryption (internal only)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>StartTls</computeroutput>  </para>
</entry><entry thead="no"><para>587  </para>
</entry><entry thead="no"><para>Upgrade to TLS (recommended)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>StartTlsWhenAvailable</computeroutput>  </para>
</entry><entry thead="no"><para>587  </para>
</entry><entry thead="no"><para>TLS if available  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SslOnConnect</computeroutput>  </para>
</entry><entry thead="no"><para>465  </para>
</entry><entry thead="no"><para>Implicit SSL/TLS  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md85">
<title>API Services</title><para>HTTP API client service with multiple authentication modes and automatic retry.</para>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md86">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Anonymous<sp/>API</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiAnonymous(</highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Bearer<sp/>token<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithBearerToken(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;your-bearer-token&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Basic<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithBasicAuth(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;username&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>API<sp/>key<sp/>authentication<sp/>(header)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithApiKey(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;your-api-key&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;X-API-Key&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ApiKeyLocation.Header);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>API<sp/>key<sp/>authentication<sp/>(query<sp/>string)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithApiKey(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;your-api-key&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;api_key&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ApiKeyLocation.QueryString);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Client<sp/>certificate<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithCertificate(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>X509Certificate2(</highlight><highlight class="stringliteral">&quot;client.pfx&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>OAuth2<sp/>client<sp/>credentials</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApiWithOAuth2(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;https://auth.example.com/oauth/token&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;client-id&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;client-secret&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;read<sp/>write&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Full<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApi(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BaseUrl<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;https://api.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.AuthenticationMode<sp/>=<sp/>ApiAuthenticationMode.BearerToken;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BearerToken<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-token&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Timeout<sp/>=<sp/>TimeSpan.FromSeconds(30);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.MaxRetries<sp/>=<sp/>3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UseExponentialBackoff<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddHttpApi(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Api&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md87">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">DataService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>IApiService<sp/>_api;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>DataService(IApiService<sp/>api)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_api<sp/>=<sp/>api;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;User?&gt;<sp/>GetUserAsync(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Simple<sp/>GET<sp/>request</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Get($</highlight><highlight class="stringliteral">&quot;/users/{id}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>response<sp/>=<sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>response.EnsureSuccess();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>response.Deserialize&lt;User&gt;();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;User?&gt;<sp/>CreateUserAsync(User<sp/>user)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>POST<sp/>with<sp/>JSON<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Post(</highlight><highlight class="stringliteral">&quot;/users&quot;</highlight><highlight class="normal">,<sp/>user);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_api.SendAsync&lt;User&gt;(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>UpdateUserAsync(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>User<sp/>user)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>PUT<sp/>with<sp/>JSON<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Put($</highlight><highlight class="stringliteral">&quot;/users/{id}&quot;</highlight><highlight class="normal">,<sp/>user);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>PatchUserAsync(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">object</highlight><highlight class="normal"><sp/>partialData)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>PATCH<sp/>with<sp/>JSON<sp/>body</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Patch($</highlight><highlight class="stringliteral">&quot;/users/{id}&quot;</highlight><highlight class="normal">,<sp/>partialData);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>DeleteUserAsync(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DELETE<sp/>request</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Delete($</highlight><highlight class="stringliteral">&quot;/users/{id}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md88">
<title>Advanced Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">AdvancedApiService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>IApiService<sp/>_api;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>AdvancedApiService(IApiService<sp/>api)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_api<sp/>=<sp/>api;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;SearchResult&gt;<sp/>SearchAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>query,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>page)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Request<sp/>with<sp/>query<sp/>parameters<sp/>and<sp/>headers</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Get(</highlight><highlight class="stringliteral">&quot;/search&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithQuery(</highlight><highlight class="stringliteral">&quot;q&quot;</highlight><highlight class="normal">,<sp/>query)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithQuery(</highlight><highlight class="stringliteral">&quot;page&quot;</highlight><highlight class="normal">,<sp/>page.ToString())</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithHeader(</highlight><highlight class="stringliteral">&quot;X-Request-ID&quot;</highlight><highlight class="normal">,<sp/>Guid.NewGuid().ToString())</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithTimeout(TimeSpan.FromSeconds(60));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>response<sp/>=<sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(response.IsSuccess)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>response.Deserialize&lt;SearchResult&gt;()!;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(response.IsClientError)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>InvalidOperationException($</highlight><highlight class="stringliteral">&quot;Client<sp/>error:<sp/>{response.ReasonPhrase}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>HttpRequestException($</highlight><highlight class="stringliteral">&quot;Server<sp/>error:<sp/>{response.StatusCode}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>UploadFileAsync(</highlight><highlight class="keywordtype">byte</highlight><highlight class="normal">[]<sp/>fileData,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>fileName)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Binary<sp/>content</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Post(</highlight><highlight class="stringliteral">&quot;/upload&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.SetBinaryContent(fileData,<sp/></highlight><highlight class="stringliteral">&quot;application/octet-stream&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithHeader(</highlight><highlight class="stringliteral">&quot;X-File-Name&quot;</highlight><highlight class="normal">,<sp/>fileName);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>SubmitFormAsync(Dictionary&lt;string,<sp/>string&gt;<sp/>formData)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Form<sp/>URL-encoded<sp/>content</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>request<sp/>=<sp/>ApiRequest.Post(</highlight><highlight class="stringliteral">&quot;/form&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.SetFormContent(formData);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_api.SendAsync(request);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md89">
<title>Configuration Options</title><para><table rows="11" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BaseUrl</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Base URL for all requests  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AuthenticationMode</computeroutput>  </para>
</entry><entry thead="no"><para>ApiAuthenticationMode  </para>
</entry><entry thead="no"><para>Anonymous  </para>
</entry><entry thead="no"><para>Authentication method  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Timeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>30s  </para>
</entry><entry thead="no"><para>Request timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MaxRetries</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>3  </para>
</entry><entry thead="no"><para>Maximum retry attempts  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RetryDelay</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>1s  </para>
</entry><entry thead="no"><para>Delay between retries  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseExponentialBackoff</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Use exponential backoff  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ValidateCertificate</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Validate SSL certificates  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>FollowRedirects</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Follow HTTP redirects  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MaxRedirects</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>10  </para>
</entry><entry thead="no"><para>Maximum redirects to follow  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UserAgent</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>&quot;Toolbox...&quot;  </para>
</entry><entry thead="no"><para>Default User-Agent header  </para>
</entry></row>
</table>
</para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md90">
<title>Authentication Modes</title><para><table rows="7" cols="2"><row>
<entry thead="yes"><para>Mode  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Anonymous</computeroutput>  </para>
</entry><entry thead="no"><para>No authentication  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BearerToken</computeroutput>  </para>
</entry><entry thead="no"><para>Bearer token in Authorization header  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Basic</computeroutput>  </para>
</entry><entry thead="no"><para>Basic authentication (username:password)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ApiKey</computeroutput>  </para>
</entry><entry thead="no"><para>API key in header or query string  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Certificate</computeroutput>  </para>
</entry><entry thead="no"><para>Client certificate authentication  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OAuth2ClientCredentials</computeroutput>  </para>
</entry><entry thead="no"><para>OAuth2 client credentials flow  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md92">
<title>LDAP Services</title><para>Directory services for querying users, groups, and computers from various LDAP providers.</para>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md93">
<title>Active Directory</title><para>Windows Active Directory service using LDAP protocol.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md94">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Using<sp/>current<sp/>Windows<sp/>credentials</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddActiveDirectory(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Domain<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;corp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UseCurrentCredentials<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UseSsl<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Using<sp/>explicit<sp/>credentials</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddActiveDirectory(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Domain<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;corp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Server<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;dc01.corp.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>636;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UseSsl<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;CORP\\serviceaccount&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddActiveDirectory(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Toolbox:Ldap:ActiveDirectory&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md95">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">UserService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ILdapService<sp/>_ldap;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>UserService(ILdapService<sp/>ldap)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ldap<sp/>=<sp/>ldap;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;LdapUser?&gt;<sp/>FindUserAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>username)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>user<sp/>=<sp/>await<sp/>_ldap.GetUserByUsernameAsync(username);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(user<sp/>!=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Found:<sp/>{user.DisplayName}<sp/>({user.Email})&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Department:<sp/>{user.Department}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>user;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;bool&gt;<sp/>ValidateUserAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>username,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>password)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.ValidateCredentialsAsync(username,<sp/>password);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;PagedResult&lt;LdapUser&gt;&gt;<sp/>SearchUsersAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>department)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>criteria<sp/>=<sp/>LdapSearchCriteria.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithDepartment(department)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.EnabledOnly();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.SearchUsersAsync(criteria,<sp/>page:<sp/>1,<sp/>pageSize:<sp/>25);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md96">
<title>Group and Computer Operations</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Get<sp/>group<sp/>by<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>group<sp/>=<sp/>await<sp/>_ldap.GetGroupByNameAsync(</highlight><highlight class="stringliteral">&quot;Developers&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Get<sp/>group<sp/>members<sp/>with<sp/>pagination</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>members<sp/>=<sp/>await<sp/>_ldap.GetGroupMembersAsync(</highlight><highlight class="stringliteral">&quot;CN=Developers,OU=Groups,DC=example,DC=com&quot;</highlight><highlight class="normal">,<sp/>page:<sp/>1,<sp/>pageSize:<sp/>50);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Get<sp/>computer<sp/>by<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>computer<sp/>=<sp/>await<sp/>_ldap.GetComputerByNameAsync(</highlight><highlight class="stringliteral">&quot;SERVER01&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Search<sp/>servers</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>criteria<sp/>=<sp/>LdapComputerSearchCriteria.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.WithOperatingSystem(</highlight><highlight class="stringliteral">&quot;Windows<sp/>Server*&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>.EnabledOnly();</highlight></codeline>
<codeline><highlight class="normal">var<sp/>servers<sp/>=<sp/>await<sp/>_ldap.SearchComputersAsync(criteria,<sp/>page:<sp/>1,<sp/>pageSize:<sp/>25);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md97">
<title>Configuration Options</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Domain</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Fully qualified domain name  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Server</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Domain controller (auto-discovers if null)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Port</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>389  </para>
</entry><entry thead="no"><para>LDAP port (636 for SSL)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BaseDn</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Base DN for searches  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Username</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind username  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Password</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind password  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseSsl</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Use SSL/TLS (LDAPS)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseCurrentCredentials</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Use Windows integrated auth  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ValidateCertificate</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Validate SSL certificate  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ConnectionTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>30s  </para>
</entry><entry thead="no"><para>Connection timeout  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OperationTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>60s  </para>
</entry><entry thead="no"><para>Operation timeout  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md99">
<title>Azure AD / Entra ID</title><para>Azure Active Directory service using Microsoft Graph API.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md100">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Client<sp/>secret<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAzureAd(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.TenantId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-tenant-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ClientId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-client-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ClientSecret<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-client-secret&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.AuthenticationMode<sp/>=<sp/>AzureAdAuthMode.ClientSecret;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Managed<sp/>identity<sp/>(Azure-hosted<sp/>apps)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAzureAdWithManagedIdentity(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>tenantId:<sp/></highlight><highlight class="stringliteral">&quot;your-tenant-id&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>clientId:<sp/></highlight><highlight class="stringliteral">&quot;your-client-id&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Certificate<sp/>authentication</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAzureAd(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.TenantId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-tenant-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ClientId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-client-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.CertificatePath<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;/path/to/cert.pfx&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.CertificatePassword<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.AuthenticationMode<sp/>=<sp/>AzureAdAuthMode.Certificate;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAzureAd(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Toolbox:Ldap:AzureAd&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md101">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">AzureUserService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ILdapService<sp/>_azureAd;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>AzureUserService(ILdapService<sp/>azureAd)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_azureAd<sp/>=<sp/>azureAd;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;LdapUser?&gt;<sp/>GetUserAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>email)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_azureAd.GetUserByEmailAsync(email);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;IEnumerable&lt;LdapUser&gt;&gt;<sp/>SearchByDepartmentAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>department)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Azure<sp/>AD<sp/>uses<sp/>OData<sp/>filter<sp/>syntax</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_azureAd.SearchUsersAsync($</highlight><highlight class="stringliteral">&quot;department<sp/>eq<sp/>&apos;{department}&apos;&quot;</highlight><highlight class="normal">,<sp/>maxResults:<sp/>50);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;IEnumerable&lt;LdapGroup&gt;&gt;<sp/>GetSecurityGroupsAsync()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_azureAd.SearchGroupsAsync(</highlight><highlight class="stringliteral">&quot;securityEnabled<sp/>eq<sp/>true&quot;</highlight><highlight class="normal">,<sp/>maxResults:<sp/>100);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md102">
<title>Important Notes</title><para><itemizedlist>
<listitem><para>Azure AD does not support <computeroutput>ValidateCredentials()</computeroutput> - use Azure AD authentication flows instead</para>
</listitem><listitem><para>Search filters use OData syntax, not LDAP filter syntax</para>
</listitem><listitem><para>Computer queries return Azure AD joined devices</para>
</listitem></itemizedlist>
</para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md103">
<title>Configuration Options</title><para><table rows="9" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>TenantId</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Azure AD tenant ID or domain  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ClientId</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Application (client) ID  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ClientSecret</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Client secret  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AuthenticationMode</computeroutput>  </para>
</entry><entry thead="no"><para>AzureAdAuthMode  </para>
</entry><entry thead="no"><para>ClientSecret  </para>
</entry><entry thead="no"><para>Authentication method  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseManagedIdentity</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Use Azure Managed Identity  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>CertificatePath</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Path to certificate file  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>CertificateThumbprint</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Certificate thumbprint  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GraphApiBaseUrl</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>v1.0 endpoint  </para>
</entry><entry thead="no"><para>Microsoft Graph API URL  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md105">
<title>OpenLDAP</title><para>OpenLDAP or compatible Linux directory service.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md106">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Basic<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddOpenLdap(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ldap.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>389;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BaseDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;cn=admin,dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindPassword<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;secret&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.SecurityMode<sp/>=<sp/>LdapSecurityMode.StartTls;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>FreeIPA<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddOpenLdap(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;ipa.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>636;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BaseDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;uid=admin,cn=users,cn=accounts,dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindPassword<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;secret&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.SecurityMode<sp/>=<sp/>LdapSecurityMode.Ssl;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UserObjectClass<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;inetOrgPerson&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.GroupObjectClass<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;groupOfNames&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddOpenLdap(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Toolbox:Ldap:OpenLdap&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md107">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">LinuxUserService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ILdapService<sp/>_ldap;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>LinuxUserService(ILdapService<sp/>ldap)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ldap<sp/>=<sp/>ldap;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;LdapUser?&gt;<sp/>GetUserAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>uid)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.GetUserByUsernameAsync(uid);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;bool&gt;<sp/>AuthenticateAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>uid,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>password)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.ValidateCredentialsAsync(uid,<sp/>password);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md108">
<title>Configuration Options</title><para><table rows="10" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Host</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>LDAP server hostname  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Port</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>389  </para>
</entry><entry thead="no"><para>LDAP port  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BaseDn</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Base DN for searches  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BindDn</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind DN for authentication  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BindPassword</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind password  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SecurityMode</computeroutput>  </para>
</entry><entry thead="no"><para>LdapSecurityMode  </para>
</entry><entry thead="no"><para>None  </para>
</entry><entry thead="no"><para>Security mode (None, Ssl, StartTls)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UserObjectClass</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>inetOrgPerson  </para>
</entry><entry thead="no"><para>User object class  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GroupObjectClass</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>groupOfNames  </para>
</entry><entry thead="no"><para>Group object class  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UsernameAttribute</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>uid  </para>
</entry><entry thead="no"><para>Username attribute  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md110">
<title>Apple Directory</title><para>Apple Open Directory service for macOS environments.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md111">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAppleDirectory(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Host<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;od.example.com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.Port<sp/>=<sp/>389;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BaseDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindDn<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;uid=admin,cn=users,dc=example,dc=com&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.BindPassword<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;secret&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.UseSsl<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAppleDirectory(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Toolbox:Ldap:AppleDirectory&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md112">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">MacUserService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ILdapService<sp/>_ldap;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>MacUserService(ILdapService<sp/>ldap)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ldap<sp/>=<sp/>ldap;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;LdapUser?&gt;<sp/>GetMacUserAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>uid)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.GetUserByUsernameAsync(uid);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;IEnumerable&lt;string&gt;&gt;<sp/>GetUserGroupsAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>uid)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_ldap.GetUserGroupsAsync(uid);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md113">
<title>Configuration Options</title><para><table rows="10" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Host</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Directory server hostname  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Port</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>389  </para>
</entry><entry thead="no"><para>LDAP port  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BaseDn</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>-  </para>
</entry><entry thead="no"><para>Base DN  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BindDn</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind DN  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>BindPassword</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Bind password  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseSsl</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Use SSL  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UserObjectClass</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>apple-user  </para>
</entry><entry thead="no"><para>Apple user object class  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>GroupObjectClass</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>apple-group  </para>
</entry><entry thead="no"><para>Apple group object class  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UniqueIdAttribute</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>apple-generateduid  </para>
</entry><entry thead="no"><para>Unique ID attribute  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md115">
<title>Advanced Authentication</title><para>All LDAP services support advanced authentication methods beyond simple username/password authentication.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md116">
<title>Authentication Modes</title><para><table rows="11" cols="6"><row>
<entry thead="yes"><para>Mode  </para>
</entry><entry thead="yes" align='center'><para>AD  </para>
</entry><entry thead="yes" align='center'><para>Azure AD  </para>
</entry><entry thead="yes" align='center'><para>OpenLDAP  </para>
</entry><entry thead="yes" align='center'><para>Apple  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Simple</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>*  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>DN + Password  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Anonymous</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>No credentials  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Kerberos</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>GSSAPI/SPNEGO  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Ntlm</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>NTLM legacy  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Negotiate</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>Auto Kerberos/NTLM  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>IntegratedWindows</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>Current Windows context  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Certificate</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no"><para>X.509 client certificate  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SaslPlain</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>SASL PLAIN  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SaslExternal</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no"><para>SASL EXTERNAL (certificate)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SaslGssapi</computeroutput>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no" align='center'><para>**  </para>
</entry><entry thead="no" align='center'><para>  </para>
</entry><entry thead="no"><para>SASL GSSAPI (Kerberos)  </para>
</entry></row>
</table>
</para>
<para><itemizedlist>
<listitem><para>Azure AD Simple maps to ROPC (Resource Owner Password Credentials) OAuth2 flow ** Limited support - may return failure with guidance</para>
</listitem></itemizedlist>
</para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md117">
<title>Usage with Options</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Authenticate<sp/>with<sp/>options</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>authOptions<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.Simple,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;john.doe&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IncludeGroups<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>IncludeClaims<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Timeout<sp/>=<sp/>TimeSpan.FromSeconds(30)</highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>ldapService.AuthenticateAsync(authOptions);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result.IsAuthenticated)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Authenticated:<sp/>{result.Username}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;DN:<sp/>{result.UserDistinguishedName}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Groups:<sp/>{string.Join(&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;,<sp/>result.Groups<sp/>??<sp/>[])}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Failed:<sp/>{result.ErrorMessage}<sp/>({result.ErrorCode})&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md118">
<title>Kerberos Authentication (Active Directory)</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Using<sp/>current<sp/>Windows<sp/>ticket<sp/>(SSO)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>adService.AuthenticateWithKerberosAsync();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Using<sp/>explicit<sp/>credentials</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>authOptions<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.Kerberos,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Username<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;john.doe@CORP.EXAMPLE.COM&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Password<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Domain<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;CORP&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>adService.AuthenticateAsync(authOptions);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md119">
<title>Integrated Windows Authentication</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Uses<sp/>the<sp/>Windows<sp/>identity<sp/>of<sp/>the<sp/>current<sp/>process</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>authOptions<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.IntegratedWindows</highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>adService.AuthenticateAsync(authOptions);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md120">
<title>Certificate Authentication</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">System.Security.Cryptography.X509Certificates;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Using<sp/>certificate<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>cert<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>X509Certificate2(</highlight><highlight class="stringliteral">&quot;client.pfx&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>ldapService.AuthenticateWithCertificateAsync(cert);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Using<sp/>options<sp/>with<sp/>certificate<sp/>path</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>authOptions<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.Certificate,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CertificatePath<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;/path/to/client.pfx&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CertificatePassword<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>ldapService.AuthenticateAsync(authOptions);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md121">
<title>Azure AD Interactive Authentication</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Device<sp/>code<sp/>flow<sp/>(for<sp/>CLI<sp/>apps)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>azureAdService.AuthenticateWithDeviceCodeAsync(async<sp/>deviceCode<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Go<sp/>to<sp/>{deviceCode.VerificationUri}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Enter<sp/>code:<sp/>{deviceCode.UserCode}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result.IsAuthenticated)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Token:<sp/>{result.Token}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Expires:<sp/>{result.ExpiresAt}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Interactive<sp/>browser<sp/>flow<sp/>(for<sp/>desktop<sp/>apps)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>azureAdService.AuthenticateWithInteractiveBrowserAsync();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Username/Password<sp/>(ROPC<sp/>-<sp/>not<sp/>recommended)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>azureAdService.AuthenticateWithUsernamePasswordAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;user@domain.com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;password&quot;</highlight><highlight class="normal">);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md122">
<title>Querying Supported Modes</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Get<sp/>supported<sp/>authentication<sp/>modes<sp/>for<sp/>the<sp/>service</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>supportedModes<sp/>=<sp/>ldapService.GetSupportedAuthenticationModes();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">foreach</highlight><highlight class="normal"><sp/>(var<sp/>mode<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>supportedModes)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Supported:<sp/>{mode}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md123">
<title>Authentication Result</title><para>The <computeroutput>LdapAuthenticationResult</computeroutput> contains:</para>
<para><table rows="13" cols="3"><row>
<entry thead="yes"><para>Property  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>IsAuthenticated</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>Whether authentication succeeded  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Username</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>Authenticated username  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UserDistinguishedName</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>User&apos;s DN  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AuthenticationMode</computeroutput>  </para>
</entry><entry thead="no"><para>LdapAuthenticationMode  </para>
</entry><entry thead="no"><para>Mode used  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DirectoryType</computeroutput>  </para>
</entry><entry thead="no"><para>LdapDirectoryType  </para>
</entry><entry thead="no"><para>Directory type  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ErrorMessage</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>Error description (if failed)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ErrorCode</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>LDAP error code  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Groups</computeroutput>  </para>
</entry><entry thead="no"><para>IReadOnlyList&lt;string&gt;?  </para>
</entry><entry thead="no"><para>User&apos;s groups (if requested)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Claims</computeroutput>  </para>
</entry><entry thead="no"><para>IDictionary&lt;string, object&gt;?  </para>
</entry><entry thead="no"><para>Additional claims  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AuthenticatedAt</computeroutput>  </para>
</entry><entry thead="no"><para>DateTimeOffset?  </para>
</entry><entry thead="no"><para>Authentication timestamp  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Token</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>OAuth token (Azure AD)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ExpiresAt</computeroutput>  </para>
</entry><entry thead="no"><para>DateTimeOffset?  </para>
</entry><entry thead="no"><para>Token expiration  </para>
</entry></row>
</table>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md124">
<title>LDAP Management Operations</title><para>All LDAP services (Active Directory, OpenLDAP, Apple Directory) support account management operations. Azure AD is read-only through Graph API.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md125">
<title>Account Management</title><para>Enable, disable, and unlock user or computer accounts.</para>
<para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Enable<sp/>an<sp/>account</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>enableResult<sp/>=<sp/>await<sp/>_ldap.EnableAccountAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithObjectType(LdapObjectType.User));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Disable<sp/>an<sp/>account</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>disableResult<sp/>=<sp/>await<sp/>_ldap.DisableAccountAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUserDn(</highlight><highlight class="stringliteral">&quot;CN=John<sp/>Doe,OU=Users,DC=contoso,DC=com&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Unlock<sp/>a<sp/>locked<sp/>account</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>unlockResult<sp/>=<sp/>await<sp/>_ldap.UnlockAccountAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md126">
<title>Group Membership</title><para>Add or remove members from groups.</para>
<para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Add<sp/>user<sp/>to<sp/>group</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>addResult<sp/>=<sp/>await<sp/>_ldap.AddToGroupAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapGroupMembershipOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForGroup(</highlight><highlight class="stringliteral">&quot;IT-Department&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithMemberUsername(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Add<sp/>multiple<sp/>users<sp/>to<sp/>a<sp/>group<sp/>(batch)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>batchAddResult<sp/>=<sp/>await<sp/>_ldap.AddToGroupBatchAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapGroupMembershipOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForGroup(</highlight><highlight class="stringliteral">&quot;Developers&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithMemberDns(</highlight><highlight class="keyword">new</highlight><highlight class="normal">[]<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CN=John<sp/>Doe,OU=Users,DC=contoso,DC=com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CN=Jane<sp/>Smith,OU=Users,DC=contoso,DC=com&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ContinueOnErrors());<sp/></highlight><highlight class="comment">//<sp/>Continue<sp/>even<sp/>if<sp/>one<sp/>fails</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Remove<sp/>user<sp/>from<sp/>group</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>removeResult<sp/>=<sp/>await<sp/>_ldap.RemoveFromGroupAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapGroupMembershipOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForGroupDn(</highlight><highlight class="stringliteral">&quot;CN=IT-Department,OU=Groups,DC=contoso,DC=com&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithMemberUsername(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">));</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md127">
<title>Object Movement</title><para>Move objects between organizational units (OUs).</para>
<para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Move<sp/>user<sp/>to<sp/>another<sp/>OU</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>moveResult<sp/>=<sp/>await<sp/>_ldap.MoveObjectAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapMoveOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.FromDn(</highlight><highlight class="stringliteral">&quot;CN=John<sp/>Doe,OU=Users,DC=contoso,DC=com&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ToContainer(</highlight><highlight class="stringliteral">&quot;OU=Contractors,DC=contoso,DC=com&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Rename<sp/>an<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>renameResult<sp/>=<sp/>await<sp/>_ldap.RenameObjectAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;CN=Old<sp/>Name,OU=Users,DC=contoso,DC=com&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;New<sp/>Name&quot;</highlight><highlight class="normal">);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md128">
<title>Password Management</title><para>Change and reset user passwords.</para>
<para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>User-initiated<sp/>password<sp/>change<sp/>(requires<sp/>current<sp/>password)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>changeResult<sp/>=<sp/>await<sp/>_ldap.ChangePasswordAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapPasswordOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithCurrentPassword(</highlight><highlight class="stringliteral">&quot;OldP@ssw0rd&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithNewPassword(</highlight><highlight class="stringliteral">&quot;NewP@ssw0rd!&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Administrative<sp/>password<sp/>reset<sp/>(no<sp/>current<sp/>password<sp/>needed)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>resetResult<sp/>=<sp/>await<sp/>_ldap.ResetPasswordAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapPasswordOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithNewPassword(</highlight><highlight class="stringliteral">&quot;Temp0rary!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.MustChangeAtNextLogon()<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Force<sp/>password<sp/>change</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.UnlockAccountOnReset());<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Also<sp/>unlock<sp/>if<sp/>locked</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Force<sp/>password<sp/>change<sp/>at<sp/>next<sp/>logon</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>forceResult<sp/>=<sp/>await<sp/>_ldap.ForcePasswordChangeAtNextLogonAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;jdoe&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>password<sp/>to<sp/>never<sp/>expire</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>neverExpireResult<sp/>=<sp/>await<sp/>_ldap.SetPasswordNeverExpiresAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;serviceaccount&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>neverExpires:<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md129">
<title>Azure AD Management via Microsoft Graph</title><para>Azure AD management uses Microsoft Graph API instead of LDAP. The same <computeroutput>ILdapService</computeroutput> interface works with Azure AD, but uses user IDs or UPNs instead of distinguished names.</para>
<para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Register<sp/>Azure<sp/>AD<sp/>service</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddAzureAd(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.TenantId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-tenant-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ClientId<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-client-id&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ClientSecret<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;your-client-secret&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Use<sp/>by<sp/>user<sp/>principal<sp/>name<sp/>(UPN)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>_azureAd.EnableAccountAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.ForUser(</highlight><highlight class="stringliteral">&quot;john.doe@contoso.com&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Or<sp/>by<sp/>Azure<sp/>AD<sp/>object<sp/>ID</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>result2<sp/>=<sp/>await<sp/>_azureAd.DisableAccountAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapAccountOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithDn(</highlight><highlight class="stringliteral">&quot;12345678-1234-1234-1234-123456789012&quot;</highlight><highlight class="normal">));<sp/><sp/></highlight><highlight class="comment">//<sp/>Object<sp/>ID<sp/>as<sp/>&quot;DN&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Add<sp/>user<sp/>to<sp/>Azure<sp/>AD<sp/>group</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>groupResult<sp/>=<sp/>await<sp/>_azureAd.AddToGroupAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapGroupMembershipOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForGroup(</highlight><highlight class="stringliteral">&quot;IT-Department&quot;</highlight><highlight class="normal">)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Group<sp/>display<sp/>name</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithMemberUsername(</highlight><highlight class="stringliteral">&quot;john.doe@contoso.com&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Reset<sp/>password<sp/>with<sp/>force<sp/>change<sp/>at<sp/>next<sp/>sign-in</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>passwordResult<sp/>=<sp/>await<sp/>_azureAd.ResetPasswordAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>LdapPasswordOptions.Create()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.ForUser(</highlight><highlight class="stringliteral">&quot;john.doe@contoso.com&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.WithNewPassword(</highlight><highlight class="stringliteral">&quot;Temp0rary123!&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.MustChangeAtNextLogon());</highlight></codeline>
</programlisting></para>
<para><bold>Required Microsoft Graph Permissions:</bold></para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Operation  </para>
</entry><entry thead="yes"><para>Application Permission  </para>
</entry><entry thead="yes"><para>Delegated Permission  </para>
</entry></row>
<row>
<entry thead="no"><para>Enable/Disable Account  </para>
</entry><entry thead="no"><para>User.ReadWrite.All  </para>
</entry><entry thead="no"><para>User.ReadWrite  </para>
</entry></row>
<row>
<entry thead="no"><para>Add/Remove from Group  </para>
</entry><entry thead="no"><para>GroupMember.ReadWrite.All  </para>
</entry><entry thead="no"><para>GroupMember.ReadWrite.All  </para>
</entry></row>
<row>
<entry thead="no"><para>Reset Password  </para>
</entry><entry thead="no"><para>User.ReadWrite.All  </para>
</entry><entry thead="no"><para>-  </para>
</entry></row>
<row>
<entry thead="no"><para>Force Password Change  </para>
</entry><entry thead="no"><para>User.ReadWrite.All  </para>
</entry><entry thead="no"><para>-  </para>
</entry></row>
<row>
<entry thead="no"><para>Set Password Never Expires  </para>
</entry><entry thead="no"><para>User.ReadWrite.All  </para>
</entry><entry thead="no"><para>Directory.AccessAsUser.All  </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md130">
<title>Management Result</title><para>All management operations return <computeroutput>LdapManagementResult</computeroutput>:</para>
<para><table rows="6" cols="3"><row>
<entry thead="yes"><para>Property  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>IsSuccess</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>Whether operation succeeded  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Operation</computeroutput>  </para>
</entry><entry thead="no"><para>LdapManagementOperation  </para>
</entry><entry thead="no"><para>Type of operation performed  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>TargetDistinguishedName</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>DN of affected object  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Details</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>Additional details or error message  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ErrorCode</computeroutput>  </para>
</entry><entry thead="no"><para>int?  </para>
</entry><entry thead="no"><para>LDAP error code (if failed)  </para>
</entry></row>
</table>
</para>
<para><programlisting filename=".cs"><codeline><highlight class="normal">var<sp/>result<sp/>=<sp/>await<sp/>_ldap.EnableAccountAsync(options);</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(result.IsSuccess)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>_logger.LogInformation(</highlight><highlight class="stringliteral">&quot;Enabled<sp/>account:<sp/>{Dn}&quot;</highlight><highlight class="normal">,<sp/>result.TargetDistinguishedName);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>_logger.LogError(</highlight><highlight class="stringliteral">&quot;Failed:<sp/>{Details}<sp/>(Error:<sp/>{Code})&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.Details,<sp/>result.ErrorCode);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md131">
<title>Supported Operations by Directory Type</title><para><table rows="12" cols="5"><row>
<entry thead="yes"><para>Operation  </para>
</entry><entry thead="yes"><para>Active Directory  </para>
</entry><entry thead="yes"><para>OpenLDAP  </para>
</entry><entry thead="yes"><para>Apple Directory  </para>
</entry><entry thead="yes"><para>Azure AD  </para>
</entry></row>
<row>
<entry thead="no"><para>EnableAccount  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>DisableAccount  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>UnlockAccount  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>AddToGroup  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>RemoveFromGroup  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>MoveObject  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>RenameObject  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>ChangePassword  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>ResetPassword  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>ForcePasswordChange  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
<row>
<entry thead="no"><para>SetPasswordNeverExpires  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry><entry thead="no"><para>  </para>
</entry></row>
</table>
</para>
<para><bold>Azure AD Notes:</bold><orderedlist>
<listitem><para>Azure AD uses Identity Protection for lockout management, not direct unlock</para>
</listitem><listitem><para>Azure AD has no concept of OUs; use Administrative Units for delegation</para>
</listitem><listitem><para>Password change requires delegated authentication flow (MSAL); use ResetPassword for admin resets</para>
</listitem></orderedlist>
</para>
<para>Check supported operations programmatically:</para>
<para><programlisting filename=".cs"><codeline><highlight class="normal">var<sp/>supported<sp/>=<sp/>_ldap.GetSupportedManagementOperations();</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(supported.Contains(LdapManagementOperation.EnableAccount))</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Account<sp/>enable/disable<sp/>is<sp/>supported</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect3>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md133">
<title>SSO Services</title><para>Single Sign-On services for session management, credential storage, and automatic token refresh.</para>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md134">
<title>Registration</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Extensions;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Options;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Basic<sp/>SSO<sp/>services</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSsoServices();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>With<sp/>custom<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSsoServices(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.DefaultSessionDuration<sp/>=<sp/>TimeSpan.FromHours(8);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.MaxSessionDuration<sp/>=<sp/>TimeSpan.FromDays(7);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.EnableAutoRefresh<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.RefreshThreshold<sp/>=<sp/>0.8;<sp/></highlight><highlight class="comment">//<sp/>Refresh<sp/>at<sp/>80%<sp/>of<sp/>lifetime</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.MaxSessionsPerUser<sp/>=<sp/>5;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sso.PersistSessions<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>},</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>credStore<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>credStore.Provider<sp/>=<sp/>CredentialStoreProvider.Auto;<sp/></highlight><highlight class="comment">//<sp/>Auto-detect<sp/>platform</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>credStore.ApplicationName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;MyApp&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>From<sp/>configuration</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSsoServices(configuration);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md135">
<title>Session Management</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">AuthController</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ISsoSessionManager<sp/>_sessionManager;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ILdapService<sp/>_ldapService;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>AuthController(ISsoSessionManager<sp/>sessionManager,<sp/>ILdapService<sp/>ldapService)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_sessionManager<sp/>=<sp/>sessionManager;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ldapService<sp/>=<sp/>ldapService;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;SsoSession&gt;<sp/>LoginAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>username,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>password)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Authenticate<sp/>with<sp/>LDAP</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>authResult<sp/>=<sp/>await<sp/>_ldapService.AuthenticateAsync(</highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.Simple,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Username<sp/>=<sp/>username,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Password<sp/>=<sp/>password,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IncludeGroups<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!authResult.IsAuthenticated)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>AuthenticationException(authResult.ErrorMessage);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>SSO<sp/>session</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_sessionManager.CreateSessionAsync(authResult,<sp/>_ldapService);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;SsoSession&gt;<sp/>LoginWithDeviceBindingAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>username,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>password,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>deviceId,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>ipAddress,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userAgent)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>authResult<sp/>=<sp/>await<sp/>_ldapService.AuthenticateAsync(</highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>LdapAuthenticationOptions</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Mode<sp/>=<sp/>LdapAuthenticationMode.Simple,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Username<sp/>=<sp/>username,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Password<sp/>=<sp/>password</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>});</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!authResult.IsAuthenticated)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>AuthenticationException(authResult.ErrorMessage);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Create<sp/>session<sp/>with<sp/>device<sp/>binding</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_sessionManager.CreateSessionAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>authResult,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ldapService,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deviceId,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ipAddress,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>userAgent);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;bool&gt;<sp/>ValidateSessionAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>sessionId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>result<sp/>=<sp/>await<sp/>_sessionManager.ValidateSessionAsync(sessionId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result.IsValid;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>LogoutAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>sessionId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_sessionManager.RevokeSessionAsync(sessionId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>LogoutAllDevicesAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_sessionManager.RevokeAllUserSessionsAsync(userId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>LogoutOtherDevicesAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>currentSessionId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_sessionManager.RevokeOtherSessionsAsync(userId,<sp/>currentSessionId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md136">
<title>Session Validation</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">SessionMiddleware</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ISsoSessionManager<sp/>_sessionManager;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SessionMiddleware(ISsoSessionManager<sp/>sessionManager)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_sessionManager<sp/>=<sp/>sessionManager;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;SsoSessionValidationResult&gt;<sp/>ValidateAsync(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>sessionId,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">?<sp/>deviceId<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal">?<sp/>ipAddress<sp/>=<sp/></highlight><highlight class="keyword">null</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>result<sp/>=<sp/>await<sp/>_sessionManager.ValidateSessionAsync(sessionId,<sp/>deviceId,<sp/>ipAddress);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!result.IsValid)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(result.FailureReason)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>SsoValidationFailureReason.SessionNotFound:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Session<sp/>doesn&apos;t<sp/>exist</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>SsoValidationFailureReason.SessionExpired:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Session<sp/>has<sp/>expired</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>SsoValidationFailureReason.SessionRevoked:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Session<sp/>was<sp/>explicitly<sp/>revoked</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>SsoValidationFailureReason.DeviceMismatch:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Request<sp/>from<sp/>different<sp/>device</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>SsoValidationFailureReason.IpMismatch:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Request<sp/>from<sp/>different<sp/>IP</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md137">
<title>Session Events</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">SessionEventHandler</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>SessionEventHandler(ISsoSessionManager<sp/>sessionManager)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sessionManager.SessionCreated<sp/>+=<sp/>OnSessionCreated;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sessionManager.SessionExpiring<sp/>+=<sp/>OnSessionExpiring;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sessionManager.SessionRefreshed<sp/>+=<sp/>OnSessionRefreshed;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sessionManager.SessionExpired<sp/>+=<sp/>OnSessionExpired;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sessionManager.SessionRevoked<sp/>+=<sp/>OnSessionRevoked;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnSessionCreated(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>SsoSessionCreatedEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Session<sp/>created:<sp/>{e.Session.SessionId}<sp/>for<sp/>{e.Session.UserId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnSessionExpiring(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>SsoSessionExpiringEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Session<sp/>expiring<sp/>in<sp/>{e.TimeToExpiry}:<sp/>{e.Session.SessionId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnSessionRefreshed(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>SsoSessionRefreshedEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Session<sp/>refreshed:<sp/>{e.Session.SessionId},<sp/>new<sp/>expiry:<sp/>{e.NewExpiresAt}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnSessionExpired(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>SsoSessionExpiredEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Session<sp/>expired:<sp/>{e.SessionId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnSessionRevoked(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>SsoSessionRevokedEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Session<sp/>revoked:<sp/>{e.SessionId},<sp/>reason:<sp/>{e.Reason}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md139">
<title>Credential Storage</title><para>Secure credential storage with platform-specific implementations.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md140">
<title>Providers</title><para><table rows="7" cols="3"><row>
<entry thead="yes"><para>Provider  </para>
</entry><entry thead="yes"><para>Platform  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Auto</computeroutput>  </para>
</entry><entry thead="no"><para>All  </para>
</entry><entry thead="no"><para>Auto-detect best provider  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>WindowsCredentialManager</computeroutput>  </para>
</entry><entry thead="no"><para>Windows  </para>
</entry><entry thead="no"><para>Windows Credential Manager with DPAPI  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MacOsKeychain</computeroutput>  </para>
</entry><entry thead="no"><para>macOS  </para>
</entry><entry thead="no"><para>macOS Keychain Services (planned)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>LinuxSecretService</computeroutput>  </para>
</entry><entry thead="no"><para>Linux  </para>
</entry><entry thead="no"><para>GNOME Keyring/KDE Wallet (planned)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EncryptedFile</computeroutput>  </para>
</entry><entry thead="no"><para>All  </para>
</entry><entry thead="no"><para>AES-256-GCM encrypted JSON file  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>InMemory</computeroutput>  </para>
</entry><entry thead="no"><para>All  </para>
</entry><entry thead="no"><para>Non-persistent, for testing  </para>
</entry></row>
</table>
</para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md141">
<title>Usage</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">CredentialService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ICredentialStore<sp/>_credentialStore;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>CredentialService(ICredentialStore<sp/>credentialStore)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_credentialStore<sp/>=<sp/>credentialStore;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>StoreTokenAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>accessToken,<sp/></highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>refreshToken)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>credential<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>SsoCredential</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>UserId<sp/>=<sp/>userId,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Type<sp/>=<sp/>CredentialType.AccessToken,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AccessToken<sp/>=<sp/>accessToken,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RefreshToken<sp/>=<sp/>refreshToken,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ExpiresAt<sp/>=<sp/>DateTimeOffset.UtcNow.AddHours(1),</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DirectoryType<sp/>=<sp/>LdapDirectoryType.ActiveDirectory</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_credentialStore.StoreCredentialAsync($</highlight><highlight class="stringliteral">&quot;token:{userId}&quot;</highlight><highlight class="normal">,<sp/>credential);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;string?&gt;<sp/>GetTokenAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>credential<sp/>=<sp/>await<sp/>_credentialStore.GetCredentialAsync($</highlight><highlight class="stringliteral">&quot;token:{userId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>credential?.AccessToken;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>RemoveTokenAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_credentialStore.RemoveCredentialAsync($</highlight><highlight class="stringliteral">&quot;token:{userId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;IReadOnlyList&lt;SsoCredential&gt;&gt;<sp/>GetUserCredentialsAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>userId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_credentialStore.GetUserCredentialsAsync(userId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>CleanupExpiredAsync()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>removed<sp/>=<sp/>await<sp/>_credentialStore.CleanupExpiredAsync();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Removed<sp/>{removed}<sp/>expired<sp/>credentials&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md142">
<title>Credential Store Options</title><para><table rows="5" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>Provider</computeroutput>  </para>
</entry><entry thead="no"><para>CredentialStoreProvider  </para>
</entry><entry thead="no"><para>Auto  </para>
</entry><entry thead="no"><para>Storage provider  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ApplicationName</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>&quot;Toolbox&quot;  </para>
</entry><entry thead="no"><para>Application identifier for credentials  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>FallbackStorePath</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Path for encrypted file store  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>UseOsKeychain</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Prefer OS-native credential storage  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md144">
<title>Automatic Token Refresh</title><para>The token refresh service automatically refreshes tokens before they expire.</para>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md145">
<title>Configuration</title><para><programlisting filename=".cs"><codeline><highlight class="normal">services.AddSsoServices(sso<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.EnableAutoRefresh<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.RefreshThreshold<sp/>=<sp/>0.8;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Refresh<sp/>at<sp/>80%<sp/>of<sp/>lifetime</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.RefreshCheckInterval<sp/>=<sp/>TimeSpan.FromMinutes(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.MaxRefreshRetries<sp/>=<sp/>3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.RefreshRetryDelay<sp/>=<sp/>TimeSpan.FromSeconds(5);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sso.UseExponentialBackoff<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md146">
<title>Manual Refresh</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">TokenService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ITokenRefreshService<sp/>_refreshService;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>ISsoSessionManager<sp/>_sessionManager;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>TokenService(ITokenRefreshService<sp/>refreshService,<sp/>ISsoSessionManager<sp/>sessionManager)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_refreshService<sp/>=<sp/>refreshService;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_sessionManager<sp/>=<sp/>sessionManager;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;SsoSession?&gt;<sp/>RefreshNowAsync(</highlight><highlight class="keywordtype">string</highlight><highlight class="normal"><sp/>sessionId)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Immediate<sp/>refresh</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_refreshService.RefreshNowAsync(sessionId);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task&lt;int&gt;<sp/>RefreshAllPendingAsync()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Refresh<sp/>all<sp/>sessions<sp/>that<sp/>need<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>await<sp/>_refreshService.RefreshAllPendingAsync();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CheckStatus()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Service<sp/>running:<sp/>{_refreshService.IsRunning}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Registered<sp/>sessions:<sp/>{_refreshService.RegisteredSessionCount}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Successful<sp/>refreshes:<sp/>{_refreshService.SuccessfulRefreshCount}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Failed<sp/>refreshes:<sp/>{_refreshService.FailedRefreshCount}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Last<sp/>check:<sp/>{_refreshService.LastCheckTime}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Next<sp/>check:<sp/>{_refreshService.NextCheckTime}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
<sect3 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md147">
<title>Refresh Events</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">RefreshEventHandler</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>RefreshEventHandler(ITokenRefreshService<sp/>refreshService)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>refreshService.RefreshNeeded<sp/>+=<sp/>OnRefreshNeeded;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>refreshService.RefreshCompleted<sp/>+=<sp/>OnRefreshCompleted;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>refreshService.RefreshFailed<sp/>+=<sp/>OnRefreshFailed;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnRefreshNeeded(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>TokenRefreshNeededEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Refresh<sp/>needed<sp/>for<sp/>{e.Session.SessionId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Elapsed:<sp/>{e.LifetimeElapsedPercent:P0}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Time<sp/>to<sp/>expiry:<sp/>{e.TimeToExpiry}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnRefreshCompleted(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>TokenRefreshCompletedEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Refresh<sp/>completed<sp/>for<sp/>{e.SessionId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>New<sp/>expiry:<sp/>{e.NewExpiresAt}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Duration:<sp/>{e.RefreshDuration.TotalMilliseconds}ms&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>OnRefreshFailed(</highlight><highlight class="keywordtype">object</highlight><highlight class="normal">?<sp/>sender,<sp/>TokenRefreshFailedEventArgs<sp/>e)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;Refresh<sp/>failed<sp/>for<sp/>{e.SessionId}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Error:<sp/>{e.Exception.Message}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Retry:<sp/>{e.RetryAttempt}/{e.MaxRetries}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Console.WriteLine($</highlight><highlight class="stringliteral">&quot;<sp/><sp/>Will<sp/>retry:<sp/>{e.WillRetry}&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect3>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md148">
<title>SSO Session Options</title><para><table rows="12" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>DefaultSessionDuration</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>8 hours  </para>
</entry><entry thead="no"><para>Default session lifetime  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MaxSessionDuration</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>7 days  </para>
</entry><entry thead="no"><para>Maximum session lifetime  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>SlidingExpiration</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan?  </para>
</entry><entry thead="no"><para>30 min  </para>
</entry><entry thead="no"><para>Sliding expiration window  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RefreshThreshold</computeroutput>  </para>
</entry><entry thead="no"><para>double  </para>
</entry><entry thead="no"><para>0.8  </para>
</entry><entry thead="no"><para>Refresh at % of lifetime  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RefreshCheckInterval</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>1 min  </para>
</entry><entry thead="no"><para>Background check interval  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnableAutoRefresh</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Enable automatic refresh  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>PersistSessions</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Persist sessions to store  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>MaxSessionsPerUser</computeroutput>  </para>
</entry><entry thead="no"><para>int  </para>
</entry><entry thead="no"><para>5  </para>
</entry><entry thead="no"><para>Max concurrent sessions  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>RevokeOldestOnMaxReached</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Revoke oldest when max reached  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnforceDeviceBinding</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Require same device  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnforceIpBinding</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Require same IP address  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md150">
<title>Creating Custom Services</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md151">
<title>Synchronous Disposal</title><para>For services with synchronous cleanup:</para>
<para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Base;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">MyService<sp/>:<sp/>BaseDisposableService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>SomeResource<sp/>_resource;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>MyService(ILogger&lt;MyService&gt;<sp/>logger)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>base(</highlight><highlight class="stringliteral">&quot;MyService&quot;</highlight><highlight class="normal">,<sp/>logger)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_resource<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>SomeResource();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>DoWork()</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThrowIfDisposed();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">var<sp/>activity<sp/>=<sp/>StartActivity();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>sw<sp/>=<sp/>Stopwatch.StartNew();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_resource.Process();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RecordOperation(</highlight><highlight class="stringliteral">&quot;DoWork&quot;</highlight><highlight class="normal">,<sp/>sw.ElapsedMilliseconds);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Dispose(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>disposing)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(disposing)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_resource?.Dispose();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base.Dispose(disposing);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md152">
<title>Asynchronous Disposal</title><para>For services with async resources:</para>
<para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Base;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">MyAsyncService<sp/>:<sp/>BaseAsyncDisposableService</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal"><sp/>readonly<sp/>Stream<sp/>_stream;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>MyAsyncService(ILogger&lt;MyAsyncService&gt;<sp/>logger)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>base(</highlight><highlight class="stringliteral">&quot;MyAsyncService&quot;</highlight><highlight class="normal">,<sp/>logger)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_stream<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>FileStream(</highlight><highlight class="stringliteral">&quot;data.bin&quot;</highlight><highlight class="normal">,<sp/>FileMode.OpenOrCreate);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>ProcessAsync(CancellationToken<sp/>ct<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ThrowIfDisposed();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">var<sp/>activity<sp/>=<sp/>StartActivity();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>var<sp/>sw<sp/>=<sp/>Stopwatch.StartNew();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_stream.WriteAsync(data,<sp/>ct);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>RecordOperation(</highlight><highlight class="stringliteral">&quot;ProcessAsync&quot;</highlight><highlight class="normal">,<sp/>sw.ElapsedMilliseconds);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">override</highlight><highlight class="normal"><sp/>async<sp/>ValueTask<sp/>DisposeAsyncCore(CancellationToken<sp/>ct)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>await<sp/>_stream.DisposeAsync();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md154">
<title>OpenTelemetry Integration</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md155">
<title>Basic Tracing and Metrics</title><para><programlisting filename=".cs"><codeline><highlight class="normal">builder.Services.AddToolboxOpenTelemetry(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.EnableTracing<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.EnableMetrics<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ServiceName<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;MyApplication&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.ServiceVersion<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;1.0.0&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md156">
<title>OTLP Export</title><para><programlisting filename=".cs"><codeline><highlight class="normal">builder.Services.AddToolboxOpenTelemetry(options<sp/>=&gt;</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>options.OtlpEndpoint<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;http://localhost:4317&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal">});</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md157">
<title>Custom Instrumentation</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">using<sp/></highlight><highlight class="normal">Toolbox.Core.Telemetry;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Start<sp/>a<sp/>custom<sp/>activity</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">var<sp/>activity<sp/>=<sp/>ToolboxActivitySource.StartActivity(</highlight><highlight class="stringliteral">&quot;CustomOperation&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal">activity?.SetTag(</highlight><highlight class="stringliteral">&quot;custom.tag&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;value&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Record<sp/>metrics</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">ToolboxMeter.RecordOperation(</highlight><highlight class="stringliteral">&quot;MyService&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;CustomOp&quot;</highlight><highlight class="normal">,<sp/>elapsedMs);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md158">
<title>Available Metrics</title><para><table rows="19" cols="3"><row>
<entry thead="yes"><para>Metric  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.operations.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Total operations  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.operations.duration</computeroutput>  </para>
</entry><entry thead="no"><para>Histogram  </para>
</entry><entry thead="no"><para>Operation duration (ms)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.disposals.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Service disposal events  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.instances.active</computeroutput>  </para>
</entry><entry thead="no"><para>UpDownCounter  </para>
</entry><entry thead="no"><para>Active service instances  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.crypto.encrypt.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Encryption operations  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.crypto.decrypt.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Decryption operations  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.crypto.data.size</computeroutput>  </para>
</entry><entry thead="no"><para>Histogram  </para>
</entry><entry thead="no"><para>Data size (bytes)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.filetransfer.upload.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>File uploads  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.filetransfer.download.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>File downloads  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.filetransfer.size</computeroutput>  </para>
</entry><entry thead="no"><para>Histogram  </para>
</entry><entry thead="no"><para>File size (bytes)  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.filetransfer.errors.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>File transfer errors  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.mailing.sent.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Emails sent  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.api.requests.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>API requests  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.sso.sessions.created</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>SSO sessions created  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.sso.sessions.expired</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>SSO sessions expired  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.sso.sessions.active</computeroutput>  </para>
</entry><entry thead="no"><para>UpDownCounter  </para>
</entry><entry thead="no"><para>Active SSO sessions  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.sso.validations.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Session validations  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>toolbox.sso.refresh.count</computeroutput>  </para>
</entry><entry thead="no"><para>Counter  </para>
</entry><entry thead="no"><para>Token refreshes  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md160">
<title>Configuration Options</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md161">
<title>ToolboxOptions</title><para><table rows="4" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnableDetailedTelemetry</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Enable detailed telemetry  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ServicePrefix</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>Prefix for service names  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>AsyncDisposalTimeout</computeroutput>  </para>
</entry><entry thead="no"><para>TimeSpan  </para>
</entry><entry thead="no"><para>30s  </para>
</entry><entry thead="no"><para>Timeout for async disposal  </para>
</entry></row>
</table>
</para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md162">
<title>ToolboxTelemetryOptions</title><para><table rows="7" cols="4"><row>
<entry thead="yes"><para>Option  </para>
</entry><entry thead="yes"><para>Type  </para>
</entry><entry thead="yes"><para>Default  </para>
</entry><entry thead="yes"><para>Description  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnableTracing</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Enable distributed tracing  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnableMetrics</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>true  </para>
</entry><entry thead="no"><para>Enable metrics collection  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>EnableConsoleExport</computeroutput>  </para>
</entry><entry thead="no"><para>bool  </para>
</entry><entry thead="no"><para>false  </para>
</entry><entry thead="no"><para>Export to console  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>OtlpEndpoint</computeroutput>  </para>
</entry><entry thead="no"><para>string?  </para>
</entry><entry thead="no"><para>null  </para>
</entry><entry thead="no"><para>OTLP collector endpoint  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ServiceName</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>&quot;Toolbox&quot;  </para>
</entry><entry thead="no"><para>Service name for telemetry  </para>
</entry></row>
<row>
<entry thead="no"><para><computeroutput>ServiceVersion</computeroutput>  </para>
</entry><entry thead="no"><para>string  </para>
</entry><entry thead="no"><para>&quot;1.0.0&quot;  </para>
</entry><entry thead="no"><para>Service version  </para>
</entry></row>
</table>
</para>
<para><hruler/>
</para>
</sect2>
</sect1>
<sect1 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md164">
<title>Best Practices</title><sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md165">
<title>1. Always Check Disposal State</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>DoWork()</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ThrowIfDisposed();<sp/><sp/></highlight><highlight class="comment">//<sp/>Call<sp/>this<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>...<sp/>rest<sp/>of<sp/>method</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md166">
<title>2. Use Activity Scopes for Tracing</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>DoWorkAsync()</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">var<sp/>activity<sp/>=<sp/>StartActivity();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Activity<sp/>automatically<sp/>ends<sp/>when<sp/>scope<sp/>exits</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md167">
<title>3. Record Metrics for Performance</title><para><programlisting filename=".cs"><codeline><highlight class="normal">var<sp/>sw<sp/>=<sp/>Stopwatch.StartNew();</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>...<sp/>operation</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">RecordOperation(</highlight><highlight class="stringliteral">&quot;OperationName&quot;</highlight><highlight class="normal">,<sp/>sw.ElapsedMilliseconds);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md168">
<title>4. Handle Cancellation in Async Operations</title><para><programlisting filename=".cs"><codeline><highlight class="keyword">public</highlight><highlight class="normal"><sp/>async<sp/>Task<sp/>ProcessAsync(CancellationToken<sp/>ct<sp/>=<sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">)</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>ct.ThrowIfCancellationRequested();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>await<sp/>_service.DoWorkAsync(ct);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md169">
<title>5. Use Appropriate Service Lifetimes</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Singleton<sp/>for<sp/>stateless<sp/>services</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSingleton&lt;ICryptographyService,<sp/>AesCryptographyService&gt;();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Scoped<sp/>for<sp/>per-request<sp/>services</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddScoped&lt;IFileTransferService,<sp/>SftpFileTransferService&gt;();</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Transient<sp/>for<sp/>lightweight<sp/>services</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddTransient&lt;IMailingService,<sp/>SmtpMailingService&gt;();</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e_1autotoc_md170">
<title>6. Secure Credential Management</title><para><programlisting filename=".cs"><codeline><highlight class="comment">//<sp/>Use<sp/>configuration/secrets,<sp/>not<sp/>hardcoded<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">services.AddSmtpMailing(configuration.GetSection(</highlight><highlight class="stringliteral">&quot;Mailing&quot;</highlight><highlight class="normal">));</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Or<sp/>use<sp/>Azure<sp/>Key<sp/>Vault,<sp/>AWS<sp/>Secrets<sp/>Manager,<sp/>etc.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">var<sp/>password<sp/>=<sp/>await<sp/>secretsClient.GetSecretAsync(</highlight><highlight class="stringliteral">&quot;smtp-password&quot;</highlight><highlight class="normal">);</highlight></codeline>
</programlisting> </para>
</sect2>
</sect1>
    </detaileddescription>
    <location file="C:/Users/micde/RiderProjects/Toolbox/USAGE.md"/>
  </compounddef>
</doxygen>
