<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Toolbox: Toolbox Usage Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Toolbox<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Toolbox .net 10</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__c_1_2_users_2micde_2_rider_projects_2_toolbox_2_u_s_a_g_e.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Toolbox Usage Guide </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md11"></a></p>
<p>This guide provides detailed instructions for using the <a class="el" href="namespace_toolbox.html">Toolbox</a> library.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Table of Contents</h1>
<ol type="1">
<li>Getting Started</li>
<li>Cryptography Services<ul>
<li>Base64 Encoding</li>
<li>AES Encryption</li>
<li>RSA Encryption</li>
</ul>
</li>
<li>File Transfer Services<ul>
<li>FTP/FTPS</li>
<li>SFTP</li>
</ul>
</li>
<li>Mailing Services</li>
<li>Creating Custom Services</li>
<li>OpenTelemetry Integration</li>
<li>Configuration Options</li>
<li>Best Practices</li>
</ol>
<h1 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Getting Started</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Basic Setup</h2>
<p>Add <a class="el" href="namespace_toolbox.html">Toolbox</a> to your application:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"> </div>
<div class="line">var <a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a> = Host.CreateApplicationBuilder(args);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register Toolbox core services</span></div>
<div class="line"><a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Services.AddToolboxCore();</div>
<div class="line"> </div>
<div class="line">var <a class="code hl_variable" href="_program_8cs.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a> = <a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Build();</div>
<div class="ttc" id="a_program_8cs_html_a2f78352277081c620fd4cf92a5ce15e5"><div class="ttname"><a href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a></div><div class="ttdeci">var builder</div><div class="ttdef"><b>Definition</b> <a href="_program_8cs_source.html#l00011">Program.cs:11</a></div></div>
<div class="ttc" id="a_program_8cs_html_a7b225fcb720e4d5ed2bbf60e28a25e6d"><div class="ttname"><a href="_program_8cs.html#a7b225fcb720e4d5ed2bbf60e28a25e6d">app</a></div><div class="ttdeci">var app</div><div class="ttdef"><b>Definition</b> <a href="_program_8cs_source.html#l00033">Program.cs:33</a></div></div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_extensions_html"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a></div><div class="ttdef"><b>Definition</b> <a href="_api_service_collection_extensions_8cs_source.html#l00014">ApiServiceCollectionExtensions.cs:14</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Configuration via appsettings.json</h2>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;Toolbox&quot;: {</div>
<div class="line">    &quot;EnableDetailedTelemetry&quot;: false,</div>
<div class="line">    &quot;ServicePrefix&quot;: &quot;MyApp&quot;,</div>
<div class="line">    &quot;AsyncDisposalTimeout&quot;: &quot;00:00:30&quot;</div>
<div class="line">  },</div>
<div class="line">  &quot;Toolbox:Telemetry&quot;: {</div>
<div class="line">    &quot;EnableTracing&quot;: true,</div>
<div class="line">    &quot;EnableMetrics&quot;: true,</div>
<div class="line">    &quot;EnableConsoleExport&quot;: false,</div>
<div class="line">    &quot;ServiceName&quot;: &quot;MyApplication&quot;,</div>
<div class="line">    &quot;ServiceVersion&quot;: &quot;1.0.0&quot;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Services.AddToolboxCore(<a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Configuration);</div>
<div class="line"><a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Services.AddToolboxOpenTelemetry(<a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Configuration);</div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md17"></a>
Cryptography Services</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md18"></a>
Base64 Encoding</h2>
<p>Base64 encoding/decoding service for text obfuscation (not encryption).</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md19"></a>
Registration</h3>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Standard Base64</span></div>
<div class="line">services.AddBase64Cryptography();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// URL-safe Base64</span></div>
<div class="line">services.AddBase64Cryptography(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#aae4ac17f23177c2ad802591f98604287">Base64EncodingTable</a>.UrlSafe);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With full options</span></div>
<div class="line">services.AddBase64Cryptography(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.EncodingTable = <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#aae4ac17f23177c2ad802591f98604287">Base64EncodingTable</a>.UrlSafe;</div>
<div class="line">    options.IncludePadding = <span class="keyword">false</span>;</div>
<div class="line">});</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a></div><div class="ttdef"><b>Definition</b> <a href="_aes_key_size_8cs_source.html#l00006">AesKeySize.cs:6</a></div></div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_aae4ac17f23177c2ad802591f98604287"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#aae4ac17f23177c2ad802591f98604287">Toolbox.Core.Options.Base64EncodingTable</a></div><div class="ttdeci">Base64EncodingTable</div><div class="ttdoc">Specifies the Base64 encoding table to use.</div><div class="ttdef"><b>Definition</b> <a href="_base64_encoding_table_8cs_source.html#l00015">Base64EncodingTable.cs:16</a></div></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md20"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>MyService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly ICryptographyService _crypto;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> MyService(ICryptographyService crypto)</div>
<div class="line">    {</div>
<div class="line">        _crypto = crypto;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task ProcessAsync()</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Encode</span></div>
<div class="line">        var encoded = _crypto.Encrypt(<span class="stringliteral">&quot;Hello, World!&quot;</span>);</div>
<div class="line">        <span class="comment">// Result: &quot;SGVsbG8sIFdvcmxkIQ==&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Decode</span></div>
<div class="line">        var decoded = _crypto.Decrypt(encoded);</div>
<div class="line">        <span class="comment">// Result: &quot;Hello, World!&quot;</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Async versions</span></div>
<div class="line">        var encodedAsync = await _crypto.EncryptAsync(<span class="stringliteral">&quot;Hello&quot;</span>);</div>
<div class="line">        var decodedAsync = await _crypto.DecryptAsync(encodedAsync);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md22"></a>
AES Encryption</h2>
<p>Secure symmetric encryption using AES (CBC mode with PKCS7 padding).</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md23"></a>
Registration</h3>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate new key and IV</span></div>
<div class="line">var (key, iv) = AesCryptographyService.GenerateKey(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">AesKeySize</a>.Aes256);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register with generated key</span></div>
<div class="line">services.AddAesCryptography(key, iv);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or with key size enum</span></div>
<div class="line">services.AddAesCryptography(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">AesKeySize</a>.Aes256);</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_a6d6346e53e425a00b206f68d826e3bea"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">Toolbox.Core.Options.AesKeySize</a></div><div class="ttdeci">AesKeySize</div><div class="ttdoc">Specifies the AES key size in bits.</div><div class="ttdef"><b>Definition</b> <a href="_aes_key_size_8cs_source.html#l00015">AesKeySize.cs:16</a></div></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md24"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>SecureService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly ICryptographyService _crypto;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> SecureService(ICryptographyService crypto)</div>
<div class="line">    {</div>
<div class="line">        _crypto = crypto;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task&lt;string&gt; EncryptDataAsync(<span class="keywordtype">string</span> sensitiveData)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Encrypt (returns Base64-encoded ciphertext)</span></div>
<div class="line">        var encrypted = await _crypto.EncryptAsync(sensitiveData);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Decrypt</span></div>
<div class="line">        var decrypted = await _crypto.DecryptAsync(encrypted);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> encrypted;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md25"></a>
Key Generation</h3>
<div class="fragment"><div class="line"><span class="comment">// Generate AES-128 key</span></div>
<div class="line">var (key128, iv128) = AesCryptographyService.GenerateKey(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">AesKeySize</a>.Aes128);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate AES-192 key</span></div>
<div class="line">var (key192, iv192) = AesCryptographyService.GenerateKey(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">AesKeySize</a>.Aes192);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate AES-256 key (recommended)</span></div>
<div class="line">var (key256, iv256) = AesCryptographyService.GenerateKey(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a6d6346e53e425a00b206f68d826e3bea">AesKeySize</a>.Aes256);</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md27"></a>
RSA Encryption</h2>
<p>Asymmetric encryption using RSA with various key sizes and padding modes.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md28"></a>
Registration</h3>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate key pair</span></div>
<div class="line">var keyPair = RsaCryptographyService.GenerateKeyPair(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a7c28c5d4278a7f74d61438430114917c">RsaKeySize</a>.Rsa2048);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register with full key pair (encrypt + decrypt)</span></div>
<div class="line">services.AddRsaCryptography(</div>
<div class="line">    keyPair.PublicKey!,</div>
<div class="line">    <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a37c881e3211938fcd305b625a9671448">RsaPaddingMode</a>.OaepSha256,</div>
<div class="line">    keyPair.PrivateKey);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register with public key only (encrypt only)</span></div>
<div class="line">services.AddRsaCryptography(</div>
<div class="line">    keyPair.PublicKey!,</div>
<div class="line">    <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a37c881e3211938fcd305b625a9671448">RsaPaddingMode</a>.OaepSha256);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register with X.509 certificate</span></div>
<div class="line">var cert = <span class="keyword">new</span> X509Certificate2(<span class="stringliteral">&quot;certificate.pfx&quot;</span>, <span class="stringliteral">&quot;password&quot;</span>);</div>
<div class="line">services.AddRsaCryptography(cert, <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a37c881e3211938fcd305b625a9671448">RsaPaddingMode</a>.OaepSha256);</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_a37c881e3211938fcd305b625a9671448"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#a37c881e3211938fcd305b625a9671448">Toolbox.Core.Options.RsaPaddingMode</a></div><div class="ttdeci">RsaPaddingMode</div><div class="ttdoc">Specifies the RSA encryption padding mode.</div><div class="ttdef"><b>Definition</b> <a href="_rsa_padding_mode_8cs_source.html#l00017">RsaPaddingMode.cs:18</a></div></div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_a7c28c5d4278a7f74d61438430114917c"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#a7c28c5d4278a7f74d61438430114917c">Toolbox.Core.Options.RsaKeySize</a></div><div class="ttdeci">RsaKeySize</div><div class="ttdoc">Specifies the RSA key size in bits.</div><div class="ttdef"><b>Definition</b> <a href="_rsa_key_size_8cs_source.html#l00020">RsaKeySize.cs:21</a></div></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md29"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>AsymmetricService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly ICryptographyService _crypto;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> AsymmetricService(ICryptographyService crypto)</div>
<div class="line">    {</div>
<div class="line">        _crypto = crypto;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task&lt;(<span class="keywordtype">string</span> encrypted, <span class="keywordtype">string</span> decrypted)&gt; ProcessAsync(<span class="keywordtype">string</span> data)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Encrypt with public key</span></div>
<div class="line">        var encrypted = await _crypto.EncryptAsync(data);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Decrypt with private key (requires private key)</span></div>
<div class="line">        var decrypted = await _crypto.DecryptAsync(encrypted);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> (encrypted, decrypted);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md30"></a>
Key Generation</h3>
<div class="fragment"><div class="line"><span class="comment">// Generate key pair (bytes)</span></div>
<div class="line">var keyPair = RsaCryptographyService.GenerateKeyPair(<a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a7c28c5d4278a7f74d61438430114917c">RsaKeySize</a>.Rsa2048);</div>
<div class="line"><span class="keywordtype">byte</span>[] publicKey = keyPair.PublicKey!;</div>
<div class="line"><span class="keywordtype">byte</span>[] privateKey = keyPair.PrivateKey!;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generate self-signed certificate</span></div>
<div class="line">var certKeyPair = RsaCryptographyService.GenerateCertificate(</div>
<div class="line">    <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a7c28c5d4278a7f74d61438430114917c">RsaKeySize</a>.Rsa4096,</div>
<div class="line">    <span class="stringliteral">&quot;CN=MyApplication&quot;</span>,</div>
<div class="line">    TimeSpan.FromDays(365));</div>
<div class="line">X509Certificate2 certificate = certKeyPair.Certificate!;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Public key only (for sharing)</span></div>
<div class="line">var publicOnly = RsaCryptographyService.GenerateKeyPair(</div>
<div class="line">    <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a7c28c5d4278a7f74d61438430114917c">RsaKeySize</a>.Rsa2048,</div>
<div class="line">    includePrivateKey: <span class="keyword">false</span>);</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md31"></a>
Padding Modes</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Pkcs1</span>  </td><td class="markdownTableBodyNone">PKCS#1 v1.5 padding (legacy)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OaepSha1</span>  </td><td class="markdownTableBodyNone">OAEP with SHA-1  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">OaepSha256</span>  </td><td class="markdownTableBodyNone">OAEP with SHA-256 (recommended)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OaepSha384</span>  </td><td class="markdownTableBodyNone">OAEP with SHA-384  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">OaepSha512</span>  </td><td class="markdownTableBodyNone">OAEP with SHA-512  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md33"></a>
File Transfer Services</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md34"></a>
FTP/FTPS</h2>
<p>File transfer service for FTP and FTPS (FTP over TLS) protocols.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md35"></a>
Registration</h3>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Basic FTP</span></div>
<div class="line">services.AddFtpFileTransfer(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;ftp.example.com&quot;</span>;</div>
<div class="line">    options.Port = 21;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    options.Password = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">    options.Protocol = <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#aa64f23a5d7659cdbe89265ce2d23086c">FileTransferProtocol</a>.Ftp;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Secure FTPS</span></div>
<div class="line">services.AddFtpFileTransfer(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;ftp.example.com&quot;</span>;</div>
<div class="line">    options.Port = 21;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    options.Password = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">    options.Protocol = <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#aa64f23a5d7659cdbe89265ce2d23086c">FileTransferProtocol</a>.Ftps;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// From configuration</span></div>
<div class="line">services.AddFtpFileTransfer(configuration.GetSection(<span class="stringliteral">&quot;Ftp&quot;</span>));</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_aa64f23a5d7659cdbe89265ce2d23086c"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#aa64f23a5d7659cdbe89265ce2d23086c">Toolbox.Core.Options.FileTransferProtocol</a></div><div class="ttdeci">FileTransferProtocol</div><div class="ttdoc">Specifies the file transfer protocol to use.</div><div class="ttdef"><b>Definition</b> <a href="_file_transfer_protocol_8cs_source.html#l00014">FileTransferProtocol.cs:15</a></div></div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md36"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>FileService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly IFileTransferService _ftp;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> FileService(IFileTransferService ftp)</div>
<div class="line">    {</div>
<div class="line">        _ftp = ftp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task TransferFilesAsync()</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Upload single file</span></div>
<div class="line">        await _ftp.UploadOneAsync(</div>
<div class="line">            localPath: <span class="stringliteral">@&quot;C:\local\file.txt&quot;</span>,</div>
<div class="line">            remotePath: <span class="stringliteral">&quot;/remote/file.txt&quot;</span>,</div>
<div class="line">            overwrite: <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Download single file</span></div>
<div class="line">        await _ftp.DownloadOneAsync(</div>
<div class="line">            remotePath: <span class="stringliteral">&quot;/remote/file.txt&quot;</span>,</div>
<div class="line">            localPath: <span class="stringliteral">@&quot;C:\local\downloaded.txt&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Batch upload</span></div>
<div class="line">        var uploads = <span class="keyword">new</span>[]</div>
<div class="line">        {</div>
<div class="line">            (<span class="stringliteral">@&quot;C:\local\file1.txt&quot;</span>, <span class="stringliteral">&quot;/remote/file1.txt&quot;</span>),</div>
<div class="line">            (<span class="stringliteral">@&quot;C:\local\file2.txt&quot;</span>, <span class="stringliteral">&quot;/remote/file2.txt&quot;</span>)</div>
<div class="line">        };</div>
<div class="line">        <span class="keywordtype">int</span> successCount = await _ftp.UploadBatchAsync(uploads);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Batch download</span></div>
<div class="line">        var downloads = <span class="keyword">new</span>[]</div>
<div class="line">        {</div>
<div class="line">            (<span class="stringliteral">&quot;/remote/file1.txt&quot;</span>, <span class="stringliteral">@&quot;C:\local\file1.txt&quot;</span>),</div>
<div class="line">            (<span class="stringliteral">&quot;/remote/file2.txt&quot;</span>, <span class="stringliteral">@&quot;C:\local\file2.txt&quot;</span>)</div>
<div class="line">        };</div>
<div class="line">        <span class="keywordtype">int</span> downloaded = await _ftp.DownloadBatchAsync(downloads);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h2 class="doxsection"><a class="anchor" id="autotoc_md38"></a>
SFTP</h2>
<p>Secure file transfer over SSH (SFTP protocol).</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md39"></a>
Registration</h3>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Password authentication</span></div>
<div class="line">services.AddSftpFileTransfer(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;sftp.example.com&quot;</span>;</div>
<div class="line">    options.Port = 22;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    options.Password = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Private key authentication</span></div>
<div class="line">services.AddSftpFileTransfer(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;sftp.example.com&quot;</span>;</div>
<div class="line">    options.Port = 22;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    options.PrivateKeyPath = <span class="stringliteral">@&quot;C:\keys\id_rsa&quot;</span>;</div>
<div class="line">    options.PrivateKeyPassphrase = <span class="stringliteral">&quot;passphrase&quot;</span>; <span class="comment">// Optional</span></div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Private key from string</span></div>
<div class="line">services.AddSftpFileTransfer(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;sftp.example.com&quot;</span>;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user&quot;</span>;</div>
<div class="line">    options.PrivateKeyContent = <span class="stringliteral">&quot;-----BEGIN RSA PRIVATE KEY-----\n...&quot;</span>;</div>
<div class="line">});</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md40"></a>
Usage</h3>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>SecureFileService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly IFileTransferService _sftp;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> SecureFileService(IFileTransferService sftp)</div>
<div class="line">    {</div>
<div class="line">        _sftp = sftp;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task TransferAsync(CancellationToken ct)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Upload with cancellation support</span></div>
<div class="line">        await _sftp.UploadOneAsync(</div>
<div class="line">            <span class="stringliteral">@&quot;C:\data\report.pdf&quot;</span>,</div>
<div class="line">            <span class="stringliteral">&quot;/uploads/report.pdf&quot;</span>,</div>
<div class="line">            overwrite: <span class="keyword">true</span>,</div>
<div class="line">            ct);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Download</span></div>
<div class="line">        await _sftp.DownloadOneAsync(</div>
<div class="line">            <span class="stringliteral">&quot;/downloads/data.csv&quot;</span>,</div>
<div class="line">            <span class="stringliteral">@&quot;C:\data\data.csv&quot;</span>,</div>
<div class="line">            cancellationToken: ct);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3 class="doxsection"><a class="anchor" id="autotoc_md41"></a>
Configuration Options</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Default  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Host</span>  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">-  </td><td class="markdownTableBodyNone">Server hostname  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Port</span>  </td><td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone">21/22  </td><td class="markdownTableBodyNone">Server port  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Username</span>  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">-  </td><td class="markdownTableBodyNone">Login username  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Password</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Password (if using password auth)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">PrivateKeyPath</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Path to private key file  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">PrivateKeyContent</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Private key as string  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">PrivateKeyPassphrase</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Private key passphrase  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Protocol</span>  </td><td class="markdownTableBodyNone">FileTransferProtocol  </td><td class="markdownTableBodyNone">Ftp  </td><td class="markdownTableBodyNone">Ftp, Ftps, or Sftp  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ConnectionTimeout</span>  </td><td class="markdownTableBodyNone">TimeSpan  </td><td class="markdownTableBodyNone">30s  </td><td class="markdownTableBodyNone">Connection timeout  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OperationTimeout</span>  </td><td class="markdownTableBodyNone">TimeSpan  </td><td class="markdownTableBodyNone">5min  </td><td class="markdownTableBodyNone">Operation timeout  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">BufferSize</span>  </td><td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone">32KB  </td><td class="markdownTableBodyNone">Transfer buffer size  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">AutoCreateDirectory</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">true  </td><td class="markdownTableBodyNone">Auto-create remote directories  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md43"></a>
Mailing Services</h1>
<p>SMTP email sending service with TLS/SSL, OAuth2, and attachment support.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md44"></a>
Registration</h2>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_extensions.html">Toolbox.Core.Extensions</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_options.html">Toolbox.Core.Options</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Generic SMTP</span></div>
<div class="line">services.AddSmtpMailing(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;smtp.example.com&quot;</span>;</div>
<div class="line">    options.Port = 587;</div>
<div class="line">    options.SecurityMode = <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a0a1f76d9ade3c05f751b22ef05061453">SmtpSecurityMode</a>.StartTls;</div>
<div class="line">    options.Username = <span class="stringliteral">&quot;user@example.com&quot;</span>;</div>
<div class="line">    options.Password = <span class="stringliteral">&quot;password&quot;</span>;</div>
<div class="line">    options.DefaultFrom = <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(<span class="stringliteral">&quot;noreply@example.com&quot;</span>, <span class="stringliteral">&quot;My App&quot;</span>);</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Gmail shortcut</span></div>
<div class="line">services.AddGmailMailing(</div>
<div class="line">    email: <span class="stringliteral">&quot;myapp@gmail.com&quot;</span>,</div>
<div class="line">    appPassword: <span class="stringliteral">&quot;xxxx-xxxx-xxxx-xxxx&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Outlook/Office 365 shortcut</span></div>
<div class="line">services.AddOutlookMailing(</div>
<div class="line">    email: <span class="stringliteral">&quot;myapp@outlook.com&quot;</span>,</div>
<div class="line">    password: <span class="stringliteral">&quot;password&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Anonymous relay (internal servers)</span></div>
<div class="line">services.AddSmtpMailing(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.Host = <span class="stringliteral">&quot;mail.internal.local&quot;</span>;</div>
<div class="line">    options.Port = 25;</div>
<div class="line">    options.SecurityMode = <a class="code hl_enumeration" href="namespace_toolbox_1_1_core_1_1_options.html#a0a1f76d9ade3c05f751b22ef05061453">SmtpSecurityMode</a>.None;</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// From configuration</span></div>
<div class="line">services.AddSmtpMailing(configuration.GetSection(<span class="stringliteral">&quot;Mailing&quot;</span>));</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_a0a1f76d9ade3c05f751b22ef05061453"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#a0a1f76d9ade3c05f751b22ef05061453">Toolbox.Core.Options.SmtpSecurityMode</a></div><div class="ttdeci">SmtpSecurityMode</div><div class="ttdoc">Specifies the security mode for SMTP connections.</div><div class="ttdef"><b>Definition</b> <a href="_smtp_security_mode_8cs_source.html#l00017">SmtpSecurityMode.cs:18</a></div></div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_options_html_aaa73e3de1e09ba82a7b2435bba10d0d3"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">Toolbox.Core.Options.EmailAddress</a></div><div class="ttdeci">record EmailAddress(string Address, string? DisplayName=null)</div><div class="ttdoc">Represents an email address with an optional display name.</div><div class="ttdef"><b>Definition</b> <a href="_email_address_8cs_source.html#l00028">EmailAddress.cs:28</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md45"></a>
Usage</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>NotificationService</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly IMailingService _mailing;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> NotificationService(IMailingService mailing)</div>
<div class="line">    {</div>
<div class="line">        _mailing = mailing;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task SendWelcomeEmailAsync(<span class="keywordtype">string</span> userEmail, <span class="keywordtype">string</span> userName)</div>
<div class="line">    {</div>
<div class="line">        var message = <span class="keyword">new</span> <a class="code hl_class" href="class_toolbox_1_1_core_1_1_options_1_1_email_message.html">EmailMessage</a></div>
<div class="line">        {</div>
<div class="line">            From = <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(<span class="stringliteral">&quot;noreply@example.com&quot;</span>, <span class="stringliteral">&quot;My Application&quot;</span>),</div>
<div class="line">            Subject = <span class="stringliteral">&quot;Welcome to Our Service!&quot;</span>,</div>
<div class="line">            Body = $<span class="stringliteral">&quot;&lt;h1&gt;Welcome, {userName}!&lt;/h1&gt;&lt;p&gt;Thank you for joining us.&lt;/p&gt;&quot;</span>,</div>
<div class="line">            IsBodyHtml = <span class="keyword">true</span>,</div>
<div class="line">            To = { <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(userEmail, userName) }</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        await _mailing.SendMailAsync(message);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task SendReportAsync(<span class="keywordtype">string</span>[] recipients, <span class="keywordtype">byte</span>[] pdfReport)</div>
<div class="line">    {</div>
<div class="line">        var message = <span class="keyword">new</span> EmailMessage</div>
<div class="line">        {</div>
<div class="line">            From = <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(<span class="stringliteral">&quot;reports@example.com&quot;</span>, <span class="stringliteral">&quot;Report System&quot;</span>),</div>
<div class="line">            Subject = <span class="stringliteral">&quot;Monthly Report&quot;</span>,</div>
<div class="line">            Body = <span class="stringliteral">&quot;Please find the monthly report attached.&quot;</span>,</div>
<div class="line">            IsBodyHtml = <span class="keyword">false</span>,</div>
<div class="line">            Attachments =</div>
<div class="line">            {</div>
<div class="line">                EmailAttachment.FromBytes(pdfReport, <span class="stringliteral">&quot;report.pdf&quot;</span>, <span class="stringliteral">&quot;application/pdf&quot;</span>)</div>
<div class="line">            }</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Multiple recipients</span></div>
<div class="line">        <span class="keywordflow">foreach</span> (var recipient <span class="keywordflow">in</span> recipients)</div>
<div class="line">        {</div>
<div class="line">            message.To.Add(recipient);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        await _mailing.SendMailAsync(message);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task SendBccEmailAsync(<span class="keywordtype">string</span>[] bccRecipients)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Email with BCC only (no visible recipients)</span></div>
<div class="line">        var message = <span class="keyword">new</span> EmailMessage</div>
<div class="line">        {</div>
<div class="line">            From = <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(<span class="stringliteral">&quot;newsletter@example.com&quot;</span>),</div>
<div class="line">            Subject = <span class="stringliteral">&quot;Newsletter&quot;</span>,</div>
<div class="line">            Body = <span class="stringliteral">&quot;&lt;h1&gt;Monthly Newsletter&lt;/h1&gt;&quot;</span>,</div>
<div class="line">            IsBodyHtml = <span class="keyword">true</span></div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">foreach</span> (var bcc <span class="keywordflow">in</span> bccRecipients)</div>
<div class="line">        {</div>
<div class="line">            message.Bcc.Add(bcc);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        await _mailing.SendMailAsync(message);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_toolbox_1_1_core_1_1_options_1_1_email_message_html"><div class="ttname"><a href="class_toolbox_1_1_core_1_1_options_1_1_email_message.html">Toolbox.Core.Options.EmailMessage</a></div><div class="ttdoc">Represents an email message to be sent.</div><div class="ttdef"><b>Definition</b> <a href="_email_message_8cs_source.html#l00035">EmailMessage.cs:36</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md46"></a>
Email with Inline Images</h2>
<div class="fragment"><div class="line">var logoBytes = File.ReadAllBytes(<span class="stringliteral">&quot;logo.png&quot;</span>);</div>
<div class="line"> </div>
<div class="line">var message = <span class="keyword">new</span> <a class="code hl_class" href="class_toolbox_1_1_core_1_1_options_1_1_email_message.html">EmailMessage</a></div>
<div class="line">{</div>
<div class="line">    From = <span class="keyword">new</span> <a class="code hl_function" href="namespace_toolbox_1_1_core_1_1_options.html#aaa73e3de1e09ba82a7b2435bba10d0d3">EmailAddress</a>(<span class="stringliteral">&quot;noreply@example.com&quot;</span>),</div>
<div class="line">    Subject = <span class="stringliteral">&quot;Email with Logo&quot;</span>,</div>
<div class="line">    Body = <span class="stringliteral">@&quot;</span></div>
<div class="line"><span class="stringliteral">        &lt;html&gt;</span></div>
<div class="line"><span class="stringliteral">        &lt;body&gt;</span></div>
<div class="line"><span class="stringliteral">            &lt;img src=&#39;cid:company-logo&#39; alt=&#39;Logo&#39; /&gt;</span></div>
<div class="line"><span class="stringliteral">            &lt;h1&gt;Welcome!&lt;/h1&gt;</span></div>
<div class="line"><span class="stringliteral">        &lt;/body&gt;</span></div>
<div class="line"><span class="stringliteral">        &lt;/html&gt;&quot;</span>,</div>
<div class="line">    IsBodyHtml = <span class="keyword">true</span>,</div>
<div class="line">    To = { <span class="stringliteral">&quot;recipient@example.com&quot;</span> },</div>
<div class="line">    Attachments =</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="class_toolbox_1_1_core_1_1_options_1_1_email_attachment.html">EmailAttachment</a>.<a class="code hl_function" href="class_toolbox_1_1_core_1_1_options_1_1_email_attachment.html#a62b587e360cc79b519da2568a8b0f6f5">CreateInline</a>(logoBytes, <span class="stringliteral">&quot;logo.png&quot;</span>, <span class="stringliteral">&quot;company-logo&quot;</span>)</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">await _mailing.SendMailAsync(message);</div>
<div class="ttc" id="aclass_toolbox_1_1_core_1_1_options_1_1_email_attachment_html"><div class="ttname"><a href="class_toolbox_1_1_core_1_1_options_1_1_email_attachment.html">Toolbox.Core.Options.EmailAttachment</a></div><div class="ttdoc">Represents an email attachment.</div><div class="ttdef"><b>Definition</b> <a href="_email_attachment_8cs_source.html#l00029">EmailAttachment.cs:30</a></div></div>
<div class="ttc" id="aclass_toolbox_1_1_core_1_1_options_1_1_email_attachment_html_a62b587e360cc79b519da2568a8b0f6f5"><div class="ttname"><a href="class_toolbox_1_1_core_1_1_options_1_1_email_attachment.html#a62b587e360cc79b519da2568a8b0f6f5">Toolbox.Core.Options.EmailAttachment.CreateInline</a></div><div class="ttdeci">static EmailAttachment CreateInline(byte[] content, string fileName, string contentId, string? contentType=null)</div><div class="ttdoc">Creates an inline attachment for embedding in HTML.</div><div class="ttdef"><b>Definition</b> <a href="_email_attachment_8cs_source.html#l00136">EmailAttachment.cs:136</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md47"></a>
Configuration Options</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Default  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Host</span>  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">"localhost"  </td><td class="markdownTableBodyNone">SMTP server hostname  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Port</span>  </td><td class="markdownTableBodyNone">int  </td><td class="markdownTableBodyNone">25  </td><td class="markdownTableBodyNone">SMTP port (25, 587, 465)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">SecurityMode</span>  </td><td class="markdownTableBodyNone">SmtpSecurityMode  </td><td class="markdownTableBodyNone">Auto  </td><td class="markdownTableBodyNone">Security mode  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">Username</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">SMTP username  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Password</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">SMTP password  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OAuth2AccessToken</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">OAuth2 token (Gmail, O365)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ConnectionTimeout</span>  </td><td class="markdownTableBodyNone">TimeSpan  </td><td class="markdownTableBodyNone">30s  </td><td class="markdownTableBodyNone">Connection timeout  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OperationTimeout</span>  </td><td class="markdownTableBodyNone">TimeSpan  </td><td class="markdownTableBodyNone">2min  </td><td class="markdownTableBodyNone">Send timeout  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ValidateCertificate</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">true  </td><td class="markdownTableBodyNone">Validate SSL certificate  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">DefaultFrom</span>  </td><td class="markdownTableBodyNone">EmailAddress?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Default sender address  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">DefaultReplyTo</span>  </td><td class="markdownTableBodyNone">EmailAddress?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Default reply-to address  </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="autotoc_md48"></a>
Security Modes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode  </th><th class="markdownTableHeadNone">Port  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">Auto</span>  </td><td class="markdownTableBodyNone">-  </td><td class="markdownTableBodyNone">Automatic detection  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">None</span>  </td><td class="markdownTableBodyNone">25  </td><td class="markdownTableBodyNone">No encryption (internal only)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">StartTls</span>  </td><td class="markdownTableBodyNone">587  </td><td class="markdownTableBodyNone">Upgrade to TLS (recommended)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">StartTlsWhenAvailable</span>  </td><td class="markdownTableBodyNone">587  </td><td class="markdownTableBodyNone">TLS if available  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">SslOnConnect</span>  </td><td class="markdownTableBodyNone">465  </td><td class="markdownTableBodyNone">Implicit SSL/TLS  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md50"></a>
Creating Custom Services</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md51"></a>
Synchronous Disposal</h2>
<p>For services with synchronous cleanup:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_base.html">Toolbox.Core.Base</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>MyService : <a class="code hl_class" href="class_toolbox_1_1_core_1_1_base_1_1_base_disposable_service.html">BaseDisposableService</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly SomeResource _resource;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> MyService(ILogger&lt;MyService&gt; logger)</div>
<div class="line">        : base(<span class="stringliteral">&quot;MyService&quot;</span>, logger)</div>
<div class="line">    {</div>
<div class="line">        _resource = <span class="keyword">new</span> SomeResource();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> DoWork()</div>
<div class="line">    {</div>
<div class="line">        ThrowIfDisposed();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">using </span>var activity = StartActivity();</div>
<div class="line">        var sw = Stopwatch.StartNew();</div>
<div class="line"> </div>
<div class="line">        _resource.Process();</div>
<div class="line"> </div>
<div class="line">        RecordOperation(<span class="stringliteral">&quot;DoWork&quot;</span>, sw.ElapsedMilliseconds);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keywordtype">void</span> Dispose(<span class="keywordtype">bool</span> disposing)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (disposing)</div>
<div class="line">        {</div>
<div class="line">            _resource?.Dispose();</div>
<div class="line">        }</div>
<div class="line">        base.Dispose(disposing);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_toolbox_1_1_core_1_1_base_1_1_base_disposable_service_html"><div class="ttname"><a href="class_toolbox_1_1_core_1_1_base_1_1_base_disposable_service.html">Toolbox.Core.Base.BaseDisposableService</a></div><div class="ttdoc">Abstract base class providing a thread-safe implementation of the dispose pattern with integrated tel...</div><div class="ttdef"><b>Definition</b> <a href="_base_disposable_service_8cs_source.html#l00027">BaseDisposableService.cs:28</a></div></div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_base_html"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_base.html">Toolbox.Core.Base</a></div><div class="ttdef"><b>Definition</b> <a href="_base_async_disposable_service_8cs_source.html#l00009">BaseAsyncDisposableService.cs:9</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md52"></a>
Asynchronous Disposal</h2>
<p>For services with async resources:</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_base.html">Toolbox.Core.Base</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>MyAsyncService : <a class="code hl_class" href="class_toolbox_1_1_core_1_1_base_1_1_base_async_disposable_service.html">BaseAsyncDisposableService</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">private</span> readonly Stream _stream;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> MyAsyncService(ILogger&lt;MyAsyncService&gt; logger)</div>
<div class="line">        : base(<span class="stringliteral">&quot;MyAsyncService&quot;</span>, logger)</div>
<div class="line">    {</div>
<div class="line">        _stream = <span class="keyword">new</span> FileStream(<span class="stringliteral">&quot;data.bin&quot;</span>, FileMode.OpenOrCreate);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> async Task ProcessAsync(CancellationToken ct = <span class="keywordflow">default</span>)</div>
<div class="line">    {</div>
<div class="line">        ThrowIfDisposed();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">using </span>var activity = StartActivity();</div>
<div class="line">        var sw = Stopwatch.StartNew();</div>
<div class="line"> </div>
<div class="line">        await _stream.WriteAsync(data, ct);</div>
<div class="line"> </div>
<div class="line">        RecordOperation(<span class="stringliteral">&quot;ProcessAsync&quot;</span>, sw.ElapsedMilliseconds);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> async ValueTask DisposeAsyncCore(CancellationToken ct)</div>
<div class="line">    {</div>
<div class="line">        await _stream.DisposeAsync();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_toolbox_1_1_core_1_1_base_1_1_base_async_disposable_service_html"><div class="ttname"><a href="class_toolbox_1_1_core_1_1_base_1_1_base_async_disposable_service.html">Toolbox.Core.Base.BaseAsyncDisposableService</a></div><div class="ttdoc">Abstract base class providing asynchronous disposal with cancellation support and integrated telemetr...</div><div class="ttdef"><b>Definition</b> <a href="_base_async_disposable_service_8cs_source.html#l00028">BaseAsyncDisposableService.cs:29</a></div></div>
</div><!-- fragment --><hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md54"></a>
OpenTelemetry Integration</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md55"></a>
Basic Tracing and Metrics</h2>
<div class="fragment"><div class="line"><a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Services.AddToolboxOpenTelemetry(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.EnableTracing = <span class="keyword">true</span>;</div>
<div class="line">    options.EnableMetrics = <span class="keyword">true</span>;</div>
<div class="line">    options.ServiceName = <span class="stringliteral">&quot;MyApplication&quot;</span>;</div>
<div class="line">    options.ServiceVersion = <span class="stringliteral">&quot;1.0.0&quot;</span>;</div>
<div class="line">});</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md56"></a>
OTLP Export</h2>
<div class="fragment"><div class="line"><a class="code hl_variable" href="_program_8cs.html#a2f78352277081c620fd4cf92a5ce15e5">builder</a>.Services.AddToolboxOpenTelemetry(options =&gt;</div>
<div class="line">{</div>
<div class="line">    options.OtlpEndpoint = <span class="stringliteral">&quot;http://localhost:4317&quot;</span>;</div>
<div class="line">});</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md57"></a>
Custom Instrumentation</h2>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_namespace" href="namespace_toolbox_1_1_core_1_1_telemetry.html">Toolbox.Core.Telemetry</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Start a custom activity</span></div>
<div class="line"><span class="keyword">using </span>var activity = ToolboxActivitySource.StartActivity(<span class="stringliteral">&quot;CustomOperation&quot;</span>);</div>
<div class="line">activity?.SetTag(<span class="stringliteral">&quot;custom.tag&quot;</span>, <span class="stringliteral">&quot;value&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Record metrics</span></div>
<div class="line">ToolboxMeter.RecordOperation(<span class="stringliteral">&quot;MyService&quot;</span>, <span class="stringliteral">&quot;CustomOp&quot;</span>, elapsedMs);</div>
<div class="ttc" id="anamespace_toolbox_1_1_core_1_1_telemetry_html"><div class="ttname"><a href="namespace_toolbox_1_1_core_1_1_telemetry.html">Toolbox.Core.Telemetry</a></div><div class="ttdef"><b>Definition</b> <a href="_telemetry_constants_8cs_source.html#l00006">TelemetryConstants.cs:6</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md58"></a>
Available Metrics</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Metric  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">toolbox.operations.count</span>  </td><td class="markdownTableBodyNone">Counter  </td><td class="markdownTableBodyNone">Total operations  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">toolbox.operations.duration</span>  </td><td class="markdownTableBodyNone">Histogram  </td><td class="markdownTableBodyNone">Operation duration (ms)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">toolbox.crypto.encrypt.count</span>  </td><td class="markdownTableBodyNone">Counter  </td><td class="markdownTableBodyNone">Encryption operations  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">toolbox.crypto.decrypt.count</span>  </td><td class="markdownTableBodyNone">Counter  </td><td class="markdownTableBodyNone">Decryption operations  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">toolbox.crypto.data.size</span>  </td><td class="markdownTableBodyNone">Histogram  </td><td class="markdownTableBodyNone">Data size (bytes)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">toolbox.filetransfer.upload.count</span>  </td><td class="markdownTableBodyNone">Counter  </td><td class="markdownTableBodyNone">File uploads  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">toolbox.filetransfer.download.count</span>  </td><td class="markdownTableBodyNone">Counter  </td><td class="markdownTableBodyNone">File downloads  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">toolbox.filetransfer.size</span>  </td><td class="markdownTableBodyNone">Histogram  </td><td class="markdownTableBodyNone">File size (bytes)  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md60"></a>
Configuration Options</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md61"></a>
ToolboxOptions</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Default  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">EnableDetailedTelemetry</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">false  </td><td class="markdownTableBodyNone">Enable detailed telemetry  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">ServicePrefix</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">Prefix for service names  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">AsyncDisposalTimeout</span>  </td><td class="markdownTableBodyNone">TimeSpan  </td><td class="markdownTableBodyNone">30s  </td><td class="markdownTableBodyNone">Timeout for async disposal  </td></tr>
</table>
<h2 class="doxsection"><a class="anchor" id="autotoc_md62"></a>
ToolboxTelemetryOptions</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option  </th><th class="markdownTableHeadNone">Type  </th><th class="markdownTableHeadNone">Default  </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">EnableTracing</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">true  </td><td class="markdownTableBodyNone">Enable distributed tracing  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">EnableMetrics</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">true  </td><td class="markdownTableBodyNone">Enable metrics collection  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">EnableConsoleExport</span>  </td><td class="markdownTableBodyNone">bool  </td><td class="markdownTableBodyNone">false  </td><td class="markdownTableBodyNone">Export to console  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">OtlpEndpoint</span>  </td><td class="markdownTableBodyNone">string?  </td><td class="markdownTableBodyNone">null  </td><td class="markdownTableBodyNone">OTLP collector endpoint  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="tt">ServiceName</span>  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">"Toolbox"  </td><td class="markdownTableBodyNone">Service name for telemetry  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="tt">ServiceVersion</span>  </td><td class="markdownTableBodyNone">string  </td><td class="markdownTableBodyNone">"1.0.0"  </td><td class="markdownTableBodyNone">Service version  </td></tr>
</table>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md64"></a>
Best Practices</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md65"></a>
1. Always Check Disposal State</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keywordtype">void</span> DoWork()</div>
<div class="line">{</div>
<div class="line">    ThrowIfDisposed();  <span class="comment">// Call this first</span></div>
<div class="line">    <span class="comment">// ... rest of method</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md66"></a>
2. Use Activity Scopes for Tracing</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task DoWorkAsync()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using </span>var activity = StartActivity();</div>
<div class="line">    <span class="comment">// Activity automatically ends when scope exits</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md67"></a>
3. Record Metrics for Performance</h2>
<div class="fragment"><div class="line">var sw = Stopwatch.StartNew();</div>
<div class="line"><span class="comment">// ... operation</span></div>
<div class="line">RecordOperation(<span class="stringliteral">&quot;OperationName&quot;</span>, sw.ElapsedMilliseconds);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md68"></a>
4. Handle Cancellation in Async Operations</h2>
<div class="fragment"><div class="line"><span class="keyword">public</span> async Task ProcessAsync(CancellationToken ct = <span class="keywordflow">default</span>)</div>
<div class="line">{</div>
<div class="line">    ct.ThrowIfCancellationRequested();</div>
<div class="line">    await _service.DoWorkAsync(ct);</div>
<div class="line">}</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md69"></a>
5. Use Appropriate Service Lifetimes</h2>
<div class="fragment"><div class="line"><span class="comment">// Singleton for stateless services</span></div>
<div class="line">services.AddSingleton&lt;ICryptographyService, AesCryptographyService&gt;();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Scoped for per-request services</span></div>
<div class="line">services.AddScoped&lt;IFileTransferService, SftpFileTransferService&gt;();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Transient for lightweight services</span></div>
<div class="line">services.AddTransient&lt;IMailingService, SmtpMailingService&gt;();</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md70"></a>
6. Secure Credential Management</h2>
<div class="fragment"><div class="line"><span class="comment">// Use configuration/secrets, not hardcoded values</span></div>
<div class="line">services.AddSmtpMailing(configuration.GetSection(<span class="stringliteral">&quot;Mailing&quot;</span>));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or use Azure Key Vault, AWS Secrets Manager, etc.</span></div>
<div class="line">var password = await secretsClient.GetSecretAsync(<span class="stringliteral">&quot;smtp-password&quot;</span>);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
